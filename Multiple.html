
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Chapter 8. Multiple Agents &#8212; Brain Computation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Multiple';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Exercise: Multiple Agents" href="Multiple_Exercise.html" />
    <link rel="prev" title="Exercise: Deep Learning" href="Deep_Exercise.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="BrainComputation.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/BC_logo.png" class="logo__image only-light" alt="Brain Computation - Home"/>
    <script>document.write(`<img src="_static/BC_logo.png" class="logo__image only-dark" alt="Brain Computation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="BrainComputation.html">
                    Brain Computation: A Hands-on Guidebook
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Chapter 1. Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Neurons.html">Chapter 2. Neural Modeling and Analysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Neurons_Exercise.html">Exercise: Neural Modeling and Analysis</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Supervised.html">Chapter 3: Supervised Learning</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Supervised_Exercise.html">Exercise: Supervised Learning</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Reinforcement.html">Chapter 4. Reinforcement Learning</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Gymnasium.html">Appendix: Gymnasium</a></li>
<li class="toctree-l2"><a class="reference internal" href="Reinforcement_Exercise.html">Exercise: Reinforcement Learning</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Unsupervised.html">Chapter 5. Unsupervised Learning</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Unsupervised_Exercise.html">Exercise: Unsupervised Learning</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Bayesian.html">Chatper 6. Bayesian Approaches</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="PyStan.html">Appendix: Bayesian Model Fitting by PyStan</a></li>
<li class="toctree-l2"><a class="reference internal" href="Bayesian_Exercise.html">Exercise: Bayesian Approaches</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Deep.html">Chapter 7: Deep Learning</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Deep_Exercise.html">Exercise: Deep Learning</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">Chapter 8. Multiple Agents</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Multiple_Exercise.html">Exercise:  Multiple Agents</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Meta.html">Chapter 9. Meta-Learning</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Meta_Exercise.html">Exercise: Meta-Learning</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/oist/BrainComputation/master?urlpath=tree/Multiple.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/oist/BrainComputation/blob/master/Multiple.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>



<a href="https://github.com/oist/BrainComputation" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Multiple.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 8. Multiple Agents</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contents">Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evolutionary-algorithms">Evolutionary Algorithms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variants-of-evolutionary-algorithms">Variants of evolutionary algorithms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#genotype-phenotype-coding">Genotype/phenotype coding</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selection">Selection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mutation">Mutation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#crossover">Crossover</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-and-evolution">Learning and evolution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#game-theory">Game Theory</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-prisoners-dilemma">Example: Prisoner’s dilemma</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mixted-strategy">Mixted strategy</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-player-game">Two-Player Game</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nash-equilibrium">Nash Equilibrium</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Examples</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#symmetric-two-player-games">Symmetric two-player games</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#normal-form-of-symmetric-two-player-games">Normal form of symmetric two-player games</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#category-i-a-1-0-a-2-0-or-a-1-0-a-2-0">Category I: <span class="math notranslate nohighlight">\(a_1&lt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&gt;0\)</span> or <span class="math notranslate nohighlight">\(a_1&gt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&lt;0\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#category-ii-a-1-0-a-2-0">Category II: <span class="math notranslate nohighlight">\(a_1&gt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&gt;0\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#category-iii-a-1-0-a-2-0">Category III: <span class="math notranslate nohighlight">\(a_1&lt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&lt;0\)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evolutionary-game-theory">Evolutionary game theory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evolutionarily-stable-strategy-ess">Evolutionarily stable strategy (ESS)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ees-in-symmetric-two-player-games">EES in symmetric two-player games</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Category I: <span class="math notranslate nohighlight">\(a_1&lt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&gt;0\)</span> or <span class="math notranslate nohighlight">\(a_1&gt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&lt;0\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Category II: <span class="math notranslate nohighlight">\(a_1&gt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&gt;0\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Category III: <span class="math notranslate nohighlight">\(a_1&lt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&lt;0\)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#replicator-dynamics">Replicator Dynamics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rock-scissors-paper-game">Rock-scissors-paper game</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-by-multiple-agents">Learning by multiple agents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#game-theory-in-neuroscience">Game theory in neuroscience</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#theory-of-mind">Theory of mind</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">Exercise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-8-multiple-agents">
<h1>Chapter 8. Multiple Agents<a class="headerlink" href="#chapter-8-multiple-agents" title="Link to this heading">#</a></h1>
<div class="math notranslate nohighlight">
\[ % Latex macros
\newcommand{\mat}[1]{\begin{pmatrix} #1 \end{pmatrix}}
\newcommand{\p}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\b}[1]{\boldsymbol{#1}}
\newcommand{\c}[1]{\mathcal{#1}}
\]</div>
<section id="contents">
<h2>Contents<a class="headerlink" href="#contents" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Evolutionary algorithms</p></li>
<li><p>Game theory</p></li>
<li><p>Evolutionary game theory</p></li>
</ul>
</section>
<section id="evolutionary-algorithms">
<h2>Evolutionary Algorithms<a class="headerlink" href="#evolutionary-algorithms" title="Link to this heading">#</a></h2>
<p>Our brain is a product of the long history of evolution.
In order to understand the present organization and functioning of our brain, it is mandatory to look back into its evolutionary history.</p>
<p>Learning and evolution are complementary mechanisms for adaptation in different time and spatial scales.
Learning happens within the lifetime of each single agent, within days to seconds.
Evolution occurs across multiple generations of a group of agents constituting a species or a colony.</p>
<p>The mechanisms of learning in the brain, such as the network architecture, dynamics of neurons, and synaptic plasticity rules, are shaped by evolution to suite the features of the environment and the agents’ sensory-motor sytems.
Learning can also affect the course of evolution, by providing a wider variety of phenotypes through interaction with the physical and social environments.</p>
<p><em>Evolutionary algorithms</em> are a class of adaptation/optimization algorithms that mimick the process of biological evolution. The major components are:</p>
<ul class="simple">
<li><p>diversity in population</p></li>
<li><p>selection by fitness</p></li>
<li><p>variation by mutation/crossover</p></li>
</ul>
<p>Compared to other optimization methods like Newton’s method or gradient descent, their major features are</p>
<ul class="simple">
<li><p>global optimization</p></li>
<li><p>little assumption on the objective function</p></li>
<li><p>no gradient computation</p></li>
</ul>
</section>
<section id="variants-of-evolutionary-algorithms">
<h2>Variants of evolutionary algorithms<a class="headerlink" href="#variants-of-evolutionary-algorithms" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Genetic algorithm (GA) 	(Holland 1976)</p>
<ul>
<li><p>binary coding</p></li>
</ul>
</li>
<li><p>Evolutionary strategy		(Rechenberg &amp; Schwefel 1965)</p>
<ul>
<li><p>real numbers</p></li>
</ul>
</li>
<li><p>Evolutionary programming	(Fogel 1966)</p>
<ul>
<li><p>genotype is a finite state machine</p></li>
</ul>
</li>
<li><p>Genetic programming (GP)	(Koza 1992)</p>
<ul>
<li><p>phenotype is a program</p></li>
</ul>
</li>
</ul>
<section id="genotype-phenotype-coding">
<h3>Genotype/phenotype coding<a class="headerlink" href="#genotype-phenotype-coding" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Binary coding: <span class="math notranslate nohighlight">\(b_N,...,b_1\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[ x = \sum_{i=1}^N b_n 2^{n–1} \]</div>
<p>Some flip of a bit can cause a big jump.</p>
<ul class="simple">
<li><p>Real numbers: <span class="math notranslate nohighlight">\((x_1,...,x_N)\)</span></p></li>
<li><p>Genotype to phenotype mapping</p>
<ul>
<li><p>input to a fitness function</p></li>
<li><p>parameters of a controller for behavior</p></li>
</ul>
</li>
</ul>
</section>
<section id="selection">
<h3>Selection<a class="headerlink" href="#selection" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Roulett wheel selection (RWS):
The selection probability <span class="math notranslate nohighlight">\(p_i\)</span> for an individual of fitness <span class="math notranslate nohighlight">\(f_i\)</span> is given by</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ p_i = \frac{f_i}{\sum_{i=1}^P f_i} \]</div>
<p>where <span class="math notranslate nohighlight">\(P\)</span> is the population size.
All <span class="math notranslate nohighlight">\(f_i\)</span> have to be non-negative.</p>
<ul class="simple">
<li><p>Selection by ranking:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ p_i \propto P - rank_i \]</div>
<ul class="simple">
<li><p>Tournament selection:
Keep winners of subsets made of <span class="math notranslate nohighlight">\(k\)</span> individuals</p></li>
</ul>
</section>
<section id="mutation">
<h3>Mutation<a class="headerlink" href="#mutation" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Binary coding:
random filp of each bit</p></li>
<li><p>Real coding:
add random noise,
e.g. Gaussian: <span class="math notranslate nohighlight">\(x’ = x + \c{N}(0,\sigma^2)\)</span></p></li>
</ul>
</section>
<section id="crossover">
<h3>Crossover<a class="headerlink" href="#crossover" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Binary coding:
splicing of bit sequences</p></li>
<li><p>Blend crossover:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ x’ \in [x_1–\alpha(x_2–x_1), x_2+\alpha(x_2–x_1)] \]</div>
<ul class="simple">
<li><p>Sampling from parents’ distribution</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span><span class="w"> </span><span class="nn">mpl_toolkits.mplot3d</span><span class="w"> </span><span class="kn">import</span> <span class="n">Axes3D</span> <span class="c1"># for 3D plotting</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">EvoAlg</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A basic class of evolutionary algorithms&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fitfun</span><span class="p">,</span> <span class="n">genes</span><span class="p">,</span> <span class="n">amut</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">pcross</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new population</span>
<span class="sd">        genes: (P,C) array of int or float</span>
<span class="sd">        sigma: mutation size&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fitfun</span> <span class="o">=</span> <span class="n">fitfun</span>   <span class="c1"># fitness function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">genes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">genes</span><span class="p">)</span>  <span class="c1"># initial genotypes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># population size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genes</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># genetic code length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">amut</span> <span class="o">=</span> <span class="n">amut</span>  <span class="c1"># mutation amplitude</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pcross</span> <span class="o">=</span> <span class="n">pcross</span>  <span class="c1"># crossover probability</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fits</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)</span>  <span class="c1"># individual fitnesses</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">best</span> <span class="o">=</span> <span class="p">[]</span>    <span class="c1"># current best solution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">record</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># record of best fitness</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evaluate individuals&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">g</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">genes</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fitfun</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">best</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fits</span><span class="p">)]</span>  <span class="c1"># best solution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">record</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fits</span><span class="p">))</span>  <span class="c1"># record best fitness</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Roulette selection&quot;&quot;&quot;</span>
        <span class="n">prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fits</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fits</span><span class="p">)</span>  <span class="c1"># make sure non-negative</span>
        <span class="n">prob</span> <span class="o">=</span> <span class="n">prob</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>  <span class="c1"># normalize</span>
        <span class="n">selected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>  <span class="c1"># indices of selected</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">):</span>
            <span class="n">selected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multinomial</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">prob</span><span class="p">))</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># multinulli</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">genes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genes</span><span class="p">[</span><span class="n">selected</span><span class="p">]</span>  <span class="c1"># update the genome</span>
            
    <span class="k">def</span><span class="w"> </span><span class="nf">crossover</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pcross</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Point crossover&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">pcross</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pcross</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pcross</span>  <span class="c1"># use the default</span>
        <span class="c1"># make random pairs (assume even population)</span>
        <span class="n">pairs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">ncross</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">*</span><span class="n">pcross</span><span class="p">)</span>  <span class="c1"># number of crossed pairs</span>
        <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">[:</span><span class="n">ncross</span><span class="p">]:</span>
            <span class="c1">#if np.random.random() &gt; self.pcross:</span>
            <span class="c1">#    break  # no crossover</span>
            <span class="n">cp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># cross point</span>
            <span class="c1">#print(p, q, cp)</span>
            <span class="n">gene0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">genes</span><span class="p">[</span><span class="n">p</span><span class="p">,:</span><span class="n">cp</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">genes</span><span class="p">[</span><span class="n">q</span><span class="p">,</span><span class="n">cp</span><span class="p">:]]</span>
            <span class="n">gene1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">genes</span><span class="p">[</span><span class="n">q</span><span class="p">,:</span><span class="n">cp</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">genes</span><span class="p">[</span><span class="n">p</span><span class="p">,</span><span class="n">cp</span><span class="p">:]]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">genes</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="n">gene0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">genes</span><span class="p">[</span><span class="n">q</span><span class="p">]</span> <span class="o">=</span> <span class="n">gene1</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">mutate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amut</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mutation by gaussian noise&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">amut</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">amut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">amut</span>  <span class="c1"># use the default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">genes</span> <span class="o">+=</span> <span class="n">amut</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amut</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pcross</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;One generation&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crossover</span><span class="p">(</span><span class="n">pcross</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">amut</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fits</span>  <span class="c1"># fitness distribution</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">evolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gen</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">amut</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pcross</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Evolve multiple generations&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">gen</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generation</span><span class="p">(</span><span class="n">amut</span><span class="p">,</span> <span class="n">pcross</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">record</span>  <span class="c1"># record of best fitness</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example of Ex-Or neural network</span>
<span class="k">def</span><span class="w"> </span><span class="nf">exor_net</span><span class="p">(</span><span class="n">w</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fitness of 2-2-1 network to ExOr; w[9]&quot;&quot;&quot;</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>  <span class="c1"># input</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>  <span class="c1"># target</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># 3 units with bias and two weights</span>
    <span class="n">err</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="n">h</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">w</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:]</span><span class="nd">@x</span><span class="p">)))</span>  <span class="c1"># hidden units</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">w</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:],</span><span class="n">h</span><span class="p">)</span>  <span class="c1"># output</span>
        <span class="n">err</span> <span class="o">+=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="c1">#print(h, y, t)</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">err</span>  <span class="c1"># fitness</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create an instance of evolving ExOr network</span>
<span class="n">evexor</span> <span class="o">=</span> <span class="n">EvoAlg</span><span class="p">(</span><span class="n">exor_net</span><span class="p">,</span> <span class="n">genes</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span> <span class="n">amut</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">pcross</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run one generation</span>
<span class="n">fits</span> <span class="o">=</span> <span class="n">evexor</span><span class="o">.</span><span class="n">generation</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">fits</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;fitness&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0b6ef4d8fe8ee0235f115e24094f355654e38fcc34b5a549e7f64b56ad8c417c.png" src="_images/0b6ef4d8fe8ee0235f115e24094f355654e38fcc34b5a549e7f64b56ad8c417c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize weight distribution</span>
<span class="n">evexor</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>  <span class="c1"># </span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># plot input weight pairs</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">evexor</span><span class="o">.</span><span class="n">genes</span><span class="p">[:,</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">evexor</span><span class="o">.</span><span class="n">genes</span><span class="p">[:,</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">evexor</span><span class="o">.</span><span class="n">fits</span><span class="p">);</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d3d272e0267d552e05013a15a63d51ecbd196fb65ccf6285bde1ed45045660ac.png" src="_images/d3d272e0267d552e05013a15a63d51ecbd196fb65ccf6285bde1ed45045660ac.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Evolve generations</span>
<span class="c1"># You may need to run this many times, or restart if gets stuck</span>
<span class="n">record</span> <span class="o">=</span> <span class="n">evexor</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">amut</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">pcross</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;generation&quot;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;fitness&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/716ee0698bd34f7ff0f43a0ded474b0a528e6932823f2bbd18f38a87d963cba0.png" src="_images/716ee0698bd34f7ff0f43a0ded474b0a528e6932823f2bbd18f38a87d963cba0.png" />
</div>
</div>
</section>
</section>
<section id="learning-and-evolution">
<h2>Learning and evolution<a class="headerlink" href="#learning-and-evolution" title="Link to this heading">#</a></h2>
<p>Most learning algorithms have some parameters that need to be tuned.
In reinforcement learning, design of the reward function is a critical issue.
One way to design them is to apply an evolutionary algorithm.</p>
<p>Elfwing et al. (2011) developed a distributed evolutionary framework for a group of robots and demonstrated that reward functions as well as reinforcement learning parameters can be optimized for the task of survival and reproduction.</p>
<blockquote>
<div><p>{figure-md} Fig_ElfwingRewards
<img alt="Elfwing11rewards" src="_images/Elfwing11rewards.png" />
Evolution of reward functions for finding a battery pack in the survival task (left) and for the face of another robot in the mating task (right).</p>
</div></blockquote>
<blockquote>
<div><p>{figure-md} Fig_ElfwingParameters
<img alt="Elfwing11parameters" src="_images/Elfwing11parameters.png" />
Evolution of parameters for reinforcement learning: <span class="math notranslate nohighlight">\(\alpha\)</span>: learning rate; <span class="math notranslate nohighlight">\(\tau\)</span>: temperature for exploration; <span class="math notranslate nohighlight">\(\gamma\)</span>: temporal discounting; <span class="math notranslate nohighlight">\(\lambda\)</span>: eligibility trace decay.</p>
</div></blockquote>
<p>The mechanisms for learning, such as network architectures and synaptic plasticity rules, are also products of evolution.
Niv et al. (2002) showed in a reinforcement learning task that reward-dependent plastcity rule can be evoloved.</p>
</section>
<section id="game-theory">
<h2>Game Theory<a class="headerlink" href="#game-theory" title="Link to this heading">#</a></h2>
<p><em>Game theory</em> is a mathematical framework for modeling the interactions among multiple agents.</p>
<p>In game theory, what we call <em>agents</em> in reinforcement learning is called <em>players</em>, <em>policy</em> is called <em>strategy</em>, and <em>reward</em> or <em>fitness</em> is called <em>pay-off</em>.</p>
<ul class="simple">
<li><p>player <span class="math notranslate nohighlight">\(i \in I = \{1,...,n\}\)</span></p></li>
<li><p><em>pure strategy</em> <span class="math notranslate nohighlight">\(s \in S = \{1,...,m\}\)</span></p></li>
<li><p><em>pure strategy profile</em> for all players (<span class="math notranslate nohighlight">\(m^n\)</span> cases):</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ \b{s} = (s_1,...,s_n) \]</div>
<ul class="simple">
<li><p><em>payoff</em> for player <span class="math notranslate nohighlight">\(i\)</span>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ \pi_i(\b{s}) = \pi_i(s_1,...,s_n) \]</div>
<ul class="simple">
<li><p>payoff function for all players:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ \pi(\b{s}) = (\pi_1(\b{s}),...,\pi_n(\b{s})) \]</div>
<section id="example-prisoners-dilemma">
<h3>Example: Prisoner’s dilemma<a class="headerlink" href="#example-prisoners-dilemma" title="Link to this heading">#</a></h3>
<p>Two prisoners are under interrogation.
They can <em>cooperate</em> by remaining silent to be discharged with no punishment.
If both <em>defect</em> and tell the truth, they are each given a small punshment.
If only one of them defects for plea bargaining, he/she is given a small reward while the other who tries to cooperate by remaining silent is given a big punishment.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-right"><p>you get/buddy gets</p></th>
<th class="head text-center"><p>buddy cooperates</p></th>
<th class="head text-center"><p>buddy defects</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-right"><p>you cooperate</p></td>
<td class="text-center"><p>0 / 0</p></td>
<td class="text-center"><p>-4/1</p></td>
</tr>
<tr class="row-odd"><td class="text-right"><p>you defect</p></td>
<td class="text-center"><p>1 / -4</p></td>
<td class="text-center"><p>-1 / -1</p></td>
</tr>
</tbody>
</table>
</div>
<p>What is the best thing to do in this case?
Is cooperation a viable strategy?</p>
</section>
<section id="mixted-strategy">
<h3>Mixted strategy<a class="headerlink" href="#mixted-strategy" title="Link to this heading">#</a></h3>
<p>A player’s strategy can be stochastic. That is called <em>mixed strategy</em> in game theory.</p>
<ul class="simple">
<li><p><em>mixed strategy</em> : probability of pure strategies</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\b{x} = (x_{1},...,x_{m}) \]</div>
<ul class="simple">
<li><p><em>mixed strategy profile</em> for all players:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}X = \mat{\b{x}_1 \\ \vdots \\ \b{x}_n} 
   = \mat{x_{11} &amp; \cdots &amp; x_{1m}\\
    \vdots &amp; &amp; \vdots\\
    x_{n1} &amp; \cdots &amp; x_{nm}}\end{split}\]</div>
<ul class="simple">
<li><p>probability of a pure strategy profile <span class="math notranslate nohighlight">\(\b{s}\)</span>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ x(\b{s}) = p(s_1,...,s_n|X) = x_{1,s_1}\cdots x_{n,s_n} \]</div>
<ul class="simple">
<li><p>payoff for player <span class="math notranslate nohighlight">\(i\)</span> under mixed strategy prifile <span class="math notranslate nohighlight">\(X\)</span>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ u_i(X) = \sum_\b{s} x(\b{s}) \pi_i(\b{s})
   = \sum_\b{s} x_{1,s_1}\cdots x_{n,s_n} \pi_i(s_1,...,s_n) \]</div>
<ul class="simple">
<li><p>combined payoff function</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ \b{u}(X) = (u_1(X),...,u_n(X)) \]</div>
</section>
</section>
<section id="two-player-game">
<h2>Two-Player Game<a class="headerlink" href="#two-player-game" title="Link to this heading">#</a></h2>
<p>Pay-off matrix for <em>row player</em></p>
<div class="math notranslate nohighlight">
\[ A: a_{s_1,s_2}=\pi_1(s_1,s_2) \]</div>
<p>Pay-off matrix for <em>column player</em></p>
<div class="math notranslate nohighlight">
\[ B: b_{s_1,s_2}=\pi_2(s_1,s_2) \]</div>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Prisoner’s dilemma: <span class="math notranslate nohighlight">\(S=\{cooperate, defect\}\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split} A = \mat{0 &amp; -4 \\ 1 &amp; -1}, \  B = \mat{0 &amp; 1 \\ -4 &amp; -1} \end{split}\]</div>
<ul class="simple">
<li><p>Matching pennies:  <span class="math notranslate nohighlight">\(S=\{head, tail\}\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split} A = \mat{1 &amp; -1 \\ -1 &amp; 1}, \  B = \mat{-1 &amp; 1 \\ 1 &amp; -1} \end{split}\]</div>
</section>
</section>
<section id="nash-equilibrium">
<h2>Nash Equilibrium<a class="headerlink" href="#nash-equilibrium" title="Link to this heading">#</a></h2>
<p>If a player knows other players’ strategies, what would he/she do to maximize own payoff?</p>
<p><em>Best reply</em> for player <span class="math notranslate nohighlight">\(i\)</span> is a mixed strategy <span class="math notranslate nohighlight">\(\b{x}_i\)</span> that maximizes the payoff given a mixed strategy profile of all players <span class="math notranslate nohighlight">\(X=\mat{\b{x}_1 \\ \vdots \\ \b{x}_n}\)</span>.</p>
<p><em>Nash equilibrium</em> is defined as a mixed strategy profile <span class="math notranslate nohighlight">\(X\)</span> that is a best reply to itself.</p>
<p>In other words, any strategy other than <span class="math notranslate nohighlight">\(\b{x}_i\)</span> does not give a higher payoff to player <span class="math notranslate nohighlight">\(i\)</span> while others keep their strategies <span class="math notranslate nohighlight">\(\b{x}_j (j\neq i)\)</span>.</p>
<section id="id1">
<h3>Examples<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Prisoner’s dilemma: <span class="math notranslate nohighlight">\(S=\{cooperate, defect\}\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split} A = \mat{0 &amp; -4 \\ 1 &amp; -1}, \  B = \mat{0 &amp; 1 \\ -4 &amp; -1} \end{split}\]</div>
<p>both defect <span class="math notranslate nohighlight">\( \b{x}_1 = \b{x}_2 = (0,1) \)</span></p>
<ul class="simple">
<li><p>Matching pennies: <span class="math notranslate nohighlight">\(S=\{head, tail\}\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split} A = \mat{1 &amp; -1 \\ -1 &amp; 1}, \  B = \mat{-1 &amp; 1 \\ 1 &amp; -1} \end{split}\]</div>
<p>stochastic <span class="math notranslate nohighlight">\( \b{x}_1 = \b{x}_2 = (\frac{1}{2},\frac{1}{2}) \)</span></p>
<ul class="simple">
<li><p>Coordination game: <span class="math notranslate nohighlight">\(S=\{left, right\}\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split} A = \mat{2 &amp; 0 \\ 0 &amp; 1}, \  B = A \end{split}\]</div>
<p>both go left: <span class="math notranslate nohighlight">\( \b{x}_1 = \b{x}_2 = (1,0) \)</span></p>
<p>both go right: <span class="math notranslate nohighlight">\( \b{x}_1 = \b{x}_2 = (0,1) \)</span></p>
<p>stochastic: <span class="math notranslate nohighlight">\( \b{x}_1 = \b{x}_2 = (\frac{2}{3},\frac{1}{3}) \)</span></p>
<ul class="simple">
<li><p>Hawk-Dove game:  <span class="math notranslate nohighlight">\(S=\{fight, yield\}\)</span></p>
<ul>
<li><p><span class="math notranslate nohighlight">\(v\)</span>: value of winning</p></li>
<li><p><span class="math notranslate nohighlight">\(c\)</span>: cost of fighting</p></li>
</ul>
</li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split} A = \mat{\frac{v-c}{2} &amp; v \\ 0 &amp; \frac{v}{2}}, \  B = A^T \end{split}\]</div>
<p>For examples, <span class="math notranslate nohighlight">\(v=2\)</span> and <span class="math notranslate nohighlight">\(c=6\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split} A = \mat{-2 &amp; 2 \\ 0 &amp; 1}, \ B = \mat{-2 &amp; 0 \\ 2 &amp; 1} \end{split}\]</div>
<p>player 1 is hawk, player 2 is dove: <span class="math notranslate nohighlight">\( \b{x}_1 = (1,0), \b{x}_2 = (0,1) \)</span></p>
<p>player 1 is dove, player 2 is hawk: <span class="math notranslate nohighlight">\( \b{x}_1 = (0,1), \b{x}_2 = (1,0) \)</span></p>
<p>sometimes hawk, sometimes dove: <span class="math notranslate nohighlight">\( \b{x}_1 = \b{x}_2 = (\frac{1}{3},\frac{2}{3}) \)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Game</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Visualization and simulation for game theory&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">paymat</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Setup a game with payoff matrices&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">paymat</span> <span class="o">=</span> <span class="n">paymat</span>  <span class="c1"># list of payoff matrices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">paymat</span><span class="p">)</span>  <span class="c1"># number of players</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">payoff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Payoffs for a mixed strategy profile X&quot;&quot;&quot;</span>
        <span class="n">pay0</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="nd">@self</span><span class="o">.</span><span class="n">paymat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="nd">@X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">pay1</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="nd">@self</span><span class="o">.</span><span class="n">paymat</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="nd">@X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">pay0</span><span class="p">,</span> <span class="n">pay1</span><span class="p">]</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">best_reply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Best pure strategies for a mixed strategy profile X&quot;&quot;&quot;</span>
        <span class="n">pay0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paymat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="nd">@X</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># payoffs for pure strategies</span>
        <span class="n">pay1</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="nd">@self</span><span class="o">.</span><span class="n">paymat</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">pay0</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">pay1</span><span class="p">)]</span>
        <span class="c1"># this misses mixed strategies of two best pure strategies</span>
      
    <span class="k">def</span><span class="w"> </span><span class="nf">plot_payoff</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;visualize payoff for mixed strategies for a two-player game&quot;&quot;&quot;</span>
        <span class="c1"># xg, yg = np.mgrid[0:1.01:0.05, 0:1.01:0.05]</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span> <span class="c1"># prob of taking a strategy</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="p">])</span>   <span class="c1"># mixed strategies from [1,0] to [0,1]</span>
        <span class="c1"># Payoff surfaces</span>
        <span class="n">pay0</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="nd">@self</span><span class="o">.</span><span class="n">paymat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="nd">@x</span> 
        <span class="n">pay1</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="nd">@self</span><span class="o">.</span><span class="n">paymat</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="nd">@x</span> 
        <span class="c1"># best reply lines</span>
        <span class="n">best_reps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">xj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="p">):</span>
            <span class="n">best_reps</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">best_reply</span><span class="p">([</span><span class="n">xj</span><span class="p">,</span> <span class="n">xj</span><span class="p">])</span>
        <span class="c1">#print(best_reps)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">pay0</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">best_reps</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>  <span class="c1"># best replies for player 0</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;P1 payoff&quot;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;P1 strategy&quot;</span><span class="p">);</span>  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;P2 strategy&quot;</span><span class="p">);</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">pay1</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">best_reps</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>  <span class="c1"># best replies for player 1</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;P2 payoff&quot;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;P2 strategy&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prisoner&#39;s dilemma</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">pd</span> <span class="o">=</span> <span class="n">Game</span><span class="p">([</span><span class="n">A</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">plot_payoff</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b5c6cf747e695c978bae110113ea3c4b88a7e272e86218acf95a217c8489cd4f.png" src="_images/b5c6cf747e695c978bae110113ea3c4b88a7e272e86218acf95a217c8489cd4f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Matching pennies</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">mp</span> <span class="o">=</span> <span class="n">Game</span><span class="p">([</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">])</span>
<span class="n">mp</span><span class="o">.</span><span class="n">plot_payoff</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e46e5ff94b66085f0a303a57c039635f7eca8fe9c013795a6013527dcb74a8f0.png" src="_images/e46e5ff94b66085f0a303a57c039635f7eca8fe9c013795a6013527dcb74a8f0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Coordination game</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">cg</span> <span class="o">=</span> <span class="n">Game</span><span class="p">([</span><span class="n">A</span><span class="p">,</span> <span class="n">A</span><span class="p">])</span>
<span class="n">cg</span><span class="o">.</span><span class="n">plot_payoff</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0137f24edeb9f9a1048496d0ba56184abaad9e9c17253cbfab8af6288e0a77c0.png" src="_images/0137f24edeb9f9a1048496d0ba56184abaad9e9c17253cbfab8af6288e0a77c0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hawk-Dove game</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">hd</span> <span class="o">=</span> <span class="n">Game</span><span class="p">([</span><span class="n">A</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="p">])</span>
<span class="n">hd</span><span class="o">.</span><span class="n">plot_payoff</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0a0a539aad437deb717c853cad8be2bb9e81fae6ed8e316e293eca2bfd93913e.png" src="_images/0a0a539aad437deb717c853cad8be2bb9e81fae6ed8e316e293eca2bfd93913e.png" />
</div>
</div>
</section>
</section>
<section id="symmetric-two-player-games">
<h2>Symmetric two-player games<a class="headerlink" href="#symmetric-two-player-games" title="Link to this heading">#</a></h2>
<p>If the same rule applies to both players:</p>
<div class="math notranslate nohighlight">
\[ \pi_2(s_1,s_2) = \pi_1(s_2,s_1) \]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[ B = A^T \]</div>
<p>it is called a <em>symmetric game</em>.<br />
In the above examples, the three except matching pennies are symmetric games.</p>
<p>If two players share the same payoff in a symmetric game:</p>
<div class="math notranslate nohighlight">
\[ A = B = A^T \]</div>
<p>it is called a <em>partnership game</em> or <em>doubly symmetric game</em>.<br />
In the above examples, coordination game is such an example.</p>
<section id="normal-form-of-symmetric-two-player-games">
<h3>Normal form of symmetric two-player games<a class="headerlink" href="#normal-form-of-symmetric-two-player-games" title="Link to this heading">#</a></h3>
<p>The best reply does not change if the same amount is added/subtracted from each column of the payoff matrix of a row player.</p>
<p>Thus any symmetric two-player game</p>
<div class="math notranslate nohighlight">
\[\begin{split} A = \mat{a_{11} &amp; a_{12} \\ a_{21} &amp; a_{22}}, \  B = A^T \end{split}\]</div>
<p>can be converted into a normal form</p>
<div class="math notranslate nohighlight">
\[\begin{split} A' = \mat{a_1 &amp; 0 \\ 0 &amp; a_2} \end{split}\]</div>
<p>by shifting the payoffs as</p>
<div class="math notranslate nohighlight">
\[ a_1 = a_{11}-a_{21}, \  a_2 = a_{22}-a_{12}. \]</div>
<p>Then we can classify all symmetric two-player games into three categories.</p>
<section id="category-i-a-1-0-a-2-0-or-a-1-0-a-2-0">
<h4>Category I: <span class="math notranslate nohighlight">\(a_1&lt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&gt;0\)</span> or <span class="math notranslate nohighlight">\(a_1&gt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&lt;0\)</span><a class="headerlink" href="#category-i-a-1-0-a-2-0-or-a-1-0-a-2-0" title="Link to this heading">#</a></h4>
<p>e.g. Prisoner’s dilemma:</p>
<div class="math notranslate nohighlight">
\[\begin{split} A = \mat{0 &amp; -4 \\ 1 &amp; -1} \rightarrow A' = \mat{-1 &amp; 0 \\ 0 &amp; 3} \end{split}\]</div>
<ul class="simple">
<li><p>One symmetric Nash equilibrium:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\( \b{x}_1 = \b{x}_2 = (1,0) \)</span> for <span class="math notranslate nohighlight">\(a_1&gt;0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\( \b{x}_1 = \b{x}_2 = (0,1) \)</span> for <span class="math notranslate nohighlight">\(a_2&gt;0\)</span></p></li>
</ul>
</li>
</ul>
</section>
<section id="category-ii-a-1-0-a-2-0">
<h4>Category II: <span class="math notranslate nohighlight">\(a_1&gt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&gt;0\)</span><a class="headerlink" href="#category-ii-a-1-0-a-2-0" title="Link to this heading">#</a></h4>
<p>e.g. Coordination game:</p>
<div class="math notranslate nohighlight">
\[\begin{split} A = \mat{2 &amp; 0 \\ 0 &amp; 1} \end{split}\]</div>
<ul class="simple">
<li><p>Three symmetric Nash equilibria</p>
<ul>
<li><p><span class="math notranslate nohighlight">\( \b{x}_1 = \b{x}_2 = (1,0) \)</span></p></li>
<li><p><span class="math notranslate nohighlight">\( \b{x}_1 = \b{x}_2 = (0,1) \)</span></p></li>
<li><p><span class="math notranslate nohighlight">\( \b{x}_1 = \b{x}_2 = (\frac{a_1}{a_1+a_2},\frac{a_2}{a_1+a_2}) \)</span></p></li>
</ul>
</li>
</ul>
</section>
<section id="category-iii-a-1-0-a-2-0">
<h4>Category III: <span class="math notranslate nohighlight">\(a_1&lt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&lt;0\)</span><a class="headerlink" href="#category-iii-a-1-0-a-2-0" title="Link to this heading">#</a></h4>
<p>e.g. Hawk-Dove game:</p>
<div class="math notranslate nohighlight">
\[\begin{split}A = \mat{-2 &amp; 2 \\ 0 &amp; 1}
  \rightarrow A' =  \mat{-2 &amp; 0 \\ 0 &amp; -1} \end{split}\]</div>
<ul class="simple">
<li><p>Two asymmetric and one symmetric Nash equilibria</p>
<ul>
<li><p><span class="math notranslate nohighlight">\( \b{x}_1 = (1,0), \b{x}_2 = (0,1) \)</span></p></li>
<li><p><span class="math notranslate nohighlight">\( \b{x}_1 = (0,1), \b{x}_2 = (1,0) \)</span></p></li>
<li><p><span class="math notranslate nohighlight">\( \b{x}_1 = \b{x}_2 = (\frac{a_2}{a_1+a_2},\frac{a_1}{a_1+a_2}) \)</span></p></li>
</ul>
</li>
</ul>
</section>
</section>
</section>
<section id="evolutionary-game-theory">
<h2>Evolutionary game theory<a class="headerlink" href="#evolutionary-game-theory" title="Link to this heading">#</a></h2>
<p>The Nash equilibrium in the game theory is an important tool for assessing what strategies a rational (selfish) player would take.
However, some Nash equilibria like the mixed strategy in the Coordination game (sometimes left, sometimes right) does not look like a good strategy.</p>
<p><em>Evolutionary Game Theory</em> considers what strategy is stable against introduction of mutants.</p>
</section>
<section id="evolutionarily-stable-strategy-ess">
<h2>Evolutionarily stable strategy (ESS)<a class="headerlink" href="#evolutionarily-stable-strategy-ess" title="Link to this heading">#</a></h2>
<p>Here we consider a large population of players.
Pairs are randomly drawn and play a symmetric two-player game</p>
<div class="math notranslate nohighlight">
\[ B = A^T \]</div>
<p>When most players take a mixed strategy <span class="math notranslate nohighlight">\(\b{x}\)</span>,
can a small mutant population taking another strategy <span class="math notranslate nohighlight">\(\b{y}\)</span> outperform others?</p>
<p>When a strategy <span class="math notranslate nohighlight">\(\b{x}\)</span> outperforms any mutant starategy <span class="math notranslate nohighlight">\(\b{x}\)</span>,
it is called an <em>Evolutionarily stable strategy (ESS)</em>.</p>
<p>We denote the payoff for a strategy <span class="math notranslate nohighlight">\(\b{x}\)</span> against <span class="math notranslate nohighlight">\(\b{y}\)</span> as</p>
<div class="math notranslate nohighlight">
\[ u(\b{x},\b{y}) = \b{x} A \b{y}^T \]</div>
<p>With a proportion of mutants <span class="math notranslate nohighlight">\(0&lt;\epsilon&lt;&lt;1\)</span>, the average population strategy is</p>
<div class="math notranslate nohighlight">
\[ \b{w} = \epsilon\b{y} + (1-\epsilon)\b{x} \]</div>
<p>ESS is a strategy <span class="math notranslate nohighlight">\(\b{x}\)</span> that satisfy</p>
<div class="math notranslate nohighlight">
\[ u(\b{x},\b{w})&gt;u(\b{y},\b{w}) \]</div>
<p>for any other strategy <span class="math notranslate nohighlight">\(\b{y}\)</span>.</p>
<p>ESS can be the first order:</p>
<div class="math notranslate nohighlight">
\[ u(\b{x},\b{x})&gt;u(\b{y},\b{x}) \]</div>
<p>performing better with incumbents,
or the second order:</p>
<div class="math notranslate nohighlight">
\[ u(\b{x},\b{x})=u(\b{y},\b{x}) \mbox{ and } u(\b{x},\b{y})&gt;u(\b{y},\b{y}) \]</div>
<p>performing equally with incumbents but better with mutants than themselves.</p>
<p>ESS does not require</p>
<div class="math notranslate nohighlight">
\[ u(\b{x},\b{x}) &gt; u(\b{y},\b{y}), \]</div>
<p>meaning that in another population where <span class="math notranslate nohighlight">\(\b{y}\)</span> is a majority, <span class="math notranslate nohighlight">\(\b{y}\)</span> can outperform <span class="math notranslate nohighlight">\(\b{x}\)</span> and be another ESS.</p>
<p>ESS is the best reply to itself, so that <span class="math notranslate nohighlight">\((\b{x},\b{x})\)</span> is a Nash equilibrium, but not all Nash equilibria are ESS, as we see below.</p>
<section id="ees-in-symmetric-two-player-games">
<h3>EES in symmetric two-player games<a class="headerlink" href="#ees-in-symmetric-two-player-games" title="Link to this heading">#</a></h3>
<p>Based on the categorization by the normal forms, let us see which Nash equilibrium is ESS.</p>
<section id="id2">
<h4>Category I: <span class="math notranslate nohighlight">\(a_1&lt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&gt;0\)</span> or <span class="math notranslate nohighlight">\(a_1&gt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&lt;0\)</span><a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<p>e.g. Prisoner’s dilemma:</p>
<div class="math notranslate nohighlight">
\[\begin{split} A = \mat{0 &amp; -4 \\ 1 &amp; -1} \rightarrow A' = \mat{-1 &amp; 0 \\ 0 &amp; 3} \end{split}\]</div>
<ul class="simple">
<li><p>One symmetric Nash equilibrium, which is ESS.</p>
<ul>
<li><p><span class="math notranslate nohighlight">\( \b{x}_1 = \b{x}_2 = (1,0) \)</span> for <span class="math notranslate nohighlight">\(a_1&gt;0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\( \b{x}_1 = \b{x}_2 = (0,1) \)</span> for <span class="math notranslate nohighlight">\(a_2&gt;0\)</span></p></li>
</ul>
</li>
</ul>
</section>
<section id="id3">
<h4>Category II: <span class="math notranslate nohighlight">\(a_1&gt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&gt;0\)</span><a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<p>e.g. Coordination game:</p>
<div class="math notranslate nohighlight">
\[\begin{split} A = \mat{2 &amp; 0 \\ 0 &amp; 1} \end{split}\]</div>
<ul class="simple">
<li><p>Three symmetric Nash equilibria:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\( \b{x}_1 = \b{x}_2 = (1,0) \)</span>: ESS</p></li>
<li><p><span class="math notranslate nohighlight">\( \b{x}_1 = \b{x}_2 = (0,1) \)</span>: ESS</p></li>
<li><p><span class="math notranslate nohighlight">\( \b{x}_1 = \b{x}_2 = (\frac{a_1}{a_1+a_2},\frac{a_2}{a_1+a_2}) \)</span>: not ESS</p></li>
</ul>
</li>
</ul>
</section>
<section id="id4">
<h4>Category III: <span class="math notranslate nohighlight">\(a_1&lt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&lt;0\)</span><a class="headerlink" href="#id4" title="Link to this heading">#</a></h4>
<p>e.g. Hawk-Dove game:</p>
<div class="math notranslate nohighlight">
\[\begin{split}A = \mat{-2 &amp; 2 \\ 0 &amp; 1}
  \rightarrow A' =  \mat{-2 &amp; 0 \\ 0 &amp; -1} \end{split}\]</div>
<ul class="simple">
<li><p>Two asymmetric and one symmetric Nash equilibria:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\( \b{x}_1 = (1,0), \b{x}_2 = (0,1) \)</span>: not ESS</p></li>
<li><p><span class="math notranslate nohighlight">\( \b{x}_1 = (0,1), \b{x}_2 = (1,0) \)</span>: not ESS</p></li>
<li><p><span class="math notranslate nohighlight">\( \b{x}_1 = \b{x}_2 = (\frac{a_2}{a_1+a_2},\frac{a_1}{a_1+a_2}) \)</span>: ESS</p></li>
</ul>
</li>
</ul>
</section>
</section>
</section>
<section id="replicator-dynamics">
<h2>Replicator Dynamics<a class="headerlink" href="#replicator-dynamics" title="Link to this heading">#</a></h2>
<p>In addition to analyzing the stablilty of a given strategy, evolutionary game theory allows us to predict how strategies would evolve in time.</p>
<p>For simplicity we assume that each subpopulation takes one of <span class="math notranslate nohighlight">\(K\)</span> pure strategies.</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p_i(t)\)</span>: number of players with strategy <span class="math notranslate nohighlight">\(i\in K\)</span></p></li>
<li><p>total population: <span class="math notranslate nohighlight">\(p(t)=\sum_{i=1}^K p_i(t)\)</span></p></li>
<li><p>population share: <span class="math notranslate nohighlight">\(x_i(t)=\frac{p_i(t)}{p(t)}\)</span></p></li>
<li><p>population state:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ x(t) = (x_1(t),...,x_K(t)) \]</div>
<p>If the reproduction rate is given by the payoff and fitness, the death rate is given by <span class="math notranslate nohighlight">\(d\)</span>, the growth of sub-population is given by</p>
<div class="math notranslate nohighlight">
\[
    \frac{dp_i(t)}{dt} = (\b{e}_i A\b{x}(t)^T–d)p_i(t)
\]</div>
<p>where <span class="math notranslate nohighlight">\(\b{e}_i=(0,...,1,...,0)\)</span> with <span class="math notranslate nohighlight">\(1\)</span> in <span class="math notranslate nohighlight">\(i\)</span>-th component.</p>
<p>Then the dynamics of the population share is given by</p>
<div class="math notranslate nohighlight">
\[
    \frac{dx_i(t)}{dt} = \frac{d}{dt} \frac{p_i(t)}{p(t)}
    = \frac{1}{p(t)}\frac{dp_i(t)}{dt} - \frac{p_i(t)}{p(t)^2}\frac{dp(t)}{dt}
\]</div>
<div class="math notranslate nohighlight">
\[
    = (\b{e}_i A\b{x}(t)^T–d)x_i(t) - x_i(t)\sum_{j=1}^K(\b{e}_j A\b{x}(t)^T–d)x_j(t)
\]</div>
<div class="math notranslate nohighlight">
\[
    = \b{e}_i A\b{x}(t)^T x_i(t) –\b{x}(t)A\b{x}(t)^T x_i(t) 
\]</div>
<p>which leads us to the <em>replicator equation</em>.</p>
<div class="math notranslate nohighlight">
\[
    \frac{dx_i(t)}{dt} = (\b{e}_i–\b{x}(t))A\b{x}(t)^T x_i(t)
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.integrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">odeint</span>

<span class="k">class</span><span class="w"> </span><span class="nc">RepGame</span><span class="p">(</span><span class="n">Game</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Replicator dynamics&quot;&quot;&quot;</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">repeq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;replicator equation for odeint&quot;&quot;&quot;</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paymat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="nd">@x</span> <span class="o">-</span> <span class="n">x</span><span class="nd">@self</span><span class="o">.</span><span class="n">paymat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="nd">@x</span><span class="p">)</span><span class="o">*</span><span class="n">x</span>
        <span class="k">return</span> <span class="n">dx</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">replicator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">tt</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Replicator dynamimcs</span>
<span class="sd">        x0: initial population, tt: array of time points&quot;&quot;&quot;</span>
        <span class="n">xt</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">repeq</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">xt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prisonner&#39;s dilemma</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>  <span class="c1"># payoff matrix</span>
<span class="n">pd</span> <span class="o">=</span> <span class="n">RepGame</span><span class="p">([</span><span class="n">A</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="p">])</span>
<span class="n">tt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">xt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">replicator</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]),</span> <span class="n">tt</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">xt</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c26806d4bae8adc80575b2f6ff9cde0472fdec9dffae2803f00d4d02b7d4ea4e.png" src="_images/c26806d4bae8adc80575b2f6ff9cde0472fdec9dffae2803f00d4d02b7d4ea4e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Coordination game</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">cg</span> <span class="o">=</span> <span class="n">RepGame</span><span class="p">([</span><span class="n">A</span><span class="p">,</span> <span class="n">A</span><span class="p">])</span>
<span class="n">tt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">xt</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">replicator</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]),</span> <span class="n">tt</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">xt</span><span class="p">)</span>
<span class="n">xt</span> <span class="o">=</span> <span class="n">cg</span><span class="o">.</span><span class="n">replicator</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]),</span> <span class="n">tt</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">xt</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/de4f4b938df3de96888018b045cbe973101654e005b664034f515b577d0a13e2.png" src="_images/de4f4b938df3de96888018b045cbe973101654e005b664034f515b577d0a13e2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hawk-Dove game</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">hd</span> <span class="o">=</span> <span class="n">RepGame</span><span class="p">([</span><span class="n">A</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="p">])</span>
<span class="n">tt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">xt</span> <span class="o">=</span> <span class="n">hd</span><span class="o">.</span><span class="n">replicator</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]),</span> <span class="n">tt</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">xt</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/50a6b79ca7abdc1b5e25efaa258f1a3a91faecac2ae9a035f0b951bceeaac0eb.png" src="_images/50a6b79ca7abdc1b5e25efaa258f1a3a91faecac2ae9a035f0b951bceeaac0eb.png" />
</div>
</div>
</section>
<section id="rock-scissors-paper-game">
<h2>Rock-scissors-paper game<a class="headerlink" href="#rock-scissors-paper-game" title="Link to this heading">#</a></h2>
<p>Now consider a symmetric two-player game with three pure strategies</p>
<div class="math notranslate nohighlight">
\[\begin{split} A = \mat{0 &amp; 1+a &amp; -1 \\ -1 &amp; 0 &amp; 1+a \\ 1+a &amp; -1 &amp; 0} \end{split}\]</div>
<p>The parameter <span class="math notranslate nohighlight">\(a\)</span> controls the importance of winning versus not losing.</p>
<p>There is a Nash equilibrium at <span class="math notranslate nohighlight">\(\b{x}=(\frac{1}{3},\frac{1}{3},\frac{1}{3})\)</span>. The replicator dynamics is known to show oscillatory behaviors around the equilibrium depending on the parameter <span class="math notranslate nohighlight">\(a\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rock-scissors-paper game</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># also try a = 1, a= -0.5</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">rsp</span> <span class="o">=</span> <span class="n">RepGame</span><span class="p">([</span><span class="n">A</span><span class="p">,</span> <span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="p">])</span>
<span class="n">tt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">xt</span> <span class="o">=</span> <span class="n">rsp</span><span class="o">.</span><span class="n">replicator</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]),</span> <span class="n">tt</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tt</span><span class="p">,</span> <span class="n">xt</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/24d1990264c1ab512a60719fe2f8d2fe58ac1a8c845e25ab186a53c9f7942526.png" src="_images/24d1990264c1ab512a60719fe2f8d2fe58ac1a8c845e25ab186a53c9f7942526.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xt</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">xt</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;ro&quot;</span><span class="p">)</span>  <span class="c1"># initial point</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xt</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">xt</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x_1&quot;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;x_2&quot;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;square&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4cbdbc074a0bb3a6bdefdbfaf1ec9201d044e36f150630eb5bff949a2abd1ce8.png" src="_images/4cbdbc074a0bb3a6bdefdbfaf1ec9201d044e36f150630eb5bff949a2abd1ce8.png" />
</div>
</div>
</section>
<section id="learning-by-multiple-agents">
<h2>Learning by multiple agents<a class="headerlink" href="#learning-by-multiple-agents" title="Link to this heading">#</a></h2>
<p>In the evolutionary game theory, each player is assumed to have a fixed strategy for its liftime.
What if players can change their strategies during their lifetime depending on their experiences.</p>
<p>Reinforcement learning of <em>multiple agents</em> is an active field of research.
For each agent, other agents can be considered as a part of the environment, but because the policies of other agents change by learning, it is not a stationary Markov decision process.
We can simply apply standard reinforcement learning like Q-learning, but in that case convergence is not theoretically guaranteed.
In learning the rock-scissors-paper game, appearance of chaotic dynamics has been reported (Sato et al. 2002).</p>
<p>Another possible approach is to learn a model of the behaviors of other agents, or even a model of how other agents change their behavior by learning, and then apply model-based approach to find appropriate actions (Suzuki et al. 2012).</p>
</section>
<section id="game-theory-in-neuroscience">
<h2>Game theory in neuroscience<a class="headerlink" href="#game-theory-in-neuroscience" title="Link to this heading">#</a></h2>
<p>Game theoretic settings have been used extensively in cognitive neuroscience research to assess the brain’s mechanisms for cooperative or selfish behaviors.</p>
<ul class="simple">
<li><p>Prisoner’s Dilemma</p>
<ul>
<li><p>Activation of reward circuit for cooperation (Rilling et al., 2002)</p></li>
<li><p>Reduced serotonin reduces cooperation (Wood et al., 2006)</p></li>
</ul>
</li>
<li><p>Ultimatum Game (Sanfey et al., 2003)<br />
Proposer: split money for self and other<br />
Responder: accept or reject</p></li>
</ul>
</section>
<section id="theory-of-mind">
<h2>Theory of mind<a class="headerlink" href="#theory-of-mind" title="Link to this heading">#</a></h2>
<p>The capacity for estimating and predicting other’s mental state is called <em>theory of mind</em>.
Human children acquire such capability during the course of development, but it has been suggested that that capacity is impaired in autistic children.</p>
<p>There are computational models about how model-bases reinforcement learning agents can perform cooperative behaviors (Yoshida et al. 2008).
There are also brain imaging experiments to assess what brain circuits are involved in predicting other’s behaviors (Yoshida et al. 2010; Suzuki et al. 2014).</p>
</section>
<section id="exercise">
<h2>Exercise<a class="headerlink" href="#exercise" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Try evolutionary algorithm for an optimization of your interest while varying the methods and parameters for mutaion, crossover, and selection.</p></li>
</ol>
<ol class="arabic simple" start="2">
<li><p>Model some kind of interaction between people in a game theoretic framework, define payoff matrices, and identify Nash equilibria and ESSs.</p></li>
</ol>
<ol class="arabic simple" start="3">
<li><p>See how the replicator dynamics of the rock-scissors-paper game changes with the parameter <span class="math notranslate nohighlight">\(a\)</span>.</p></li>
</ol>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Evolutionary algorithms</p>
<ul>
<li><p>Yu X, Gen M (2012) Introduction to Evolutionary Algorithms. Springer.</p></li>
<li><p>Reisinger J, Miikkulainen R (2007) Acquiring Evolvability through Adaptive Representations. GECCO 2007.</p></li>
<li><p>Elfwing S, Uchibe E, Doya K, Christensen HI (2011) Darwinian embodied evolution of the learning ability for survival. Adaptive Behavior 19:101-120.</p></li>
<li><p>Niv Y, Joel D, Meilijson I, Ruppin E (2002) Evolution of reinforcement learning in uncertain environments: a simple explanation for complex foraging behaviors. Adaptive Behavior.</p></li>
</ul>
</li>
<li><p>Game theory</p>
<ul>
<li><p>Weibull J (1995) Evolutionary Game Theory. MIT Press.</p></li>
<li><p>Rilling JK, Gutman DA, Zeh TR, Pagnoni G, Berns GS, Kilts CD (2002) A neural basis for social cooperation. Neuron 35:395-405.</p></li>
<li><p>Sanfey AG, Rilling JK, Aronson JA, Nystrom LE, Cohen JD (2003) The neural basis of economic decision-making in the Ultimatum Game. Science 300:1755-1758.</p></li>
<li><p>Barraclough DJ, Conroy ML, Lee D (2004) Prefrontal cortex and decision making in a mixed-strategy game. Nature neuroscience 7:404-410.</p></li>
</ul>
</li>
<li><p>Multi-agent RL</p>
<ul>
<li><p>Sato Y, Akiyama E, Farmer JD (2002) Chaos in learning a simple two-person game. Proceedings of the National Academy of Sciences, USA, 99:4748-4751.</p></li>
<li><p>Jaderberg M, Czarnecki WM, Dunning I, Marris L, Lever G, Castaneda AG, Beattie C, Rabinowitz NC, Morcos AS, Ruderman A, Sonnerat N, Green T, Deason L, Leibo JZ, Silver D, Hassabis D, Kavukcuoglu K, Graepel T (2019). Human-level performance in 3D multiplayer games with population-based reinforcement learning. Science, 364, 859-865. <a class="reference external" href="https://doi.org/10.1126/science.aau6249">https://doi.org/10.1126/science.aau6249</a></p></li>
</ul>
</li>
<li><p>Theory of mind</p>
<ul>
<li><p>Yoshida W, Dolan RJ, Friston KJ (2008) Game theory of mind. PLoS Computational Biology 4:e1000254.</p></li>
<li><p>Yoshida W, Seymour B, Friston KJ, Dolan RJ (2010) Neural mechanisms of belief inference during cooperative games. The Journal of Neuroscience, 30:10744-10751.</p></li>
<li><p>Suzuki S, Harasawa N, Ueno K, Gardner JL, Ichinohe N, Haruno M, Cheng K, Nakahara H (2012) Learning to simulate others’ decisions. Neuron, 74:1125-1137.</p></li>
</ul>
</li>
</ul>
</section>
<div class="toctree-wrapper compound">
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Deep_Exercise.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Exercise: Deep Learning</p>
      </div>
    </a>
    <a class="right-next"
       href="Multiple_Exercise.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Exercise:  Multiple Agents</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contents">Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evolutionary-algorithms">Evolutionary Algorithms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variants-of-evolutionary-algorithms">Variants of evolutionary algorithms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#genotype-phenotype-coding">Genotype/phenotype coding</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selection">Selection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mutation">Mutation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#crossover">Crossover</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-and-evolution">Learning and evolution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#game-theory">Game Theory</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-prisoners-dilemma">Example: Prisoner’s dilemma</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mixted-strategy">Mixted strategy</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-player-game">Two-Player Game</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nash-equilibrium">Nash Equilibrium</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Examples</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#symmetric-two-player-games">Symmetric two-player games</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#normal-form-of-symmetric-two-player-games">Normal form of symmetric two-player games</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#category-i-a-1-0-a-2-0-or-a-1-0-a-2-0">Category I: <span class="math notranslate nohighlight">\(a_1&lt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&gt;0\)</span> or <span class="math notranslate nohighlight">\(a_1&gt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&lt;0\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#category-ii-a-1-0-a-2-0">Category II: <span class="math notranslate nohighlight">\(a_1&gt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&gt;0\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#category-iii-a-1-0-a-2-0">Category III: <span class="math notranslate nohighlight">\(a_1&lt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&lt;0\)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evolutionary-game-theory">Evolutionary game theory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evolutionarily-stable-strategy-ess">Evolutionarily stable strategy (ESS)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ees-in-symmetric-two-player-games">EES in symmetric two-player games</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Category I: <span class="math notranslate nohighlight">\(a_1&lt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&gt;0\)</span> or <span class="math notranslate nohighlight">\(a_1&gt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&lt;0\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Category II: <span class="math notranslate nohighlight">\(a_1&gt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&gt;0\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Category III: <span class="math notranslate nohighlight">\(a_1&lt;0\)</span>, <span class="math notranslate nohighlight">\(a_2&lt;0\)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#replicator-dynamics">Replicator Dynamics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rock-scissors-paper-game">Rock-scissors-paper game</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-by-multiple-agents">Learning by multiple agents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#game-theory-in-neuroscience">Game theory in neuroscience</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#theory-of-mind">Theory of mind</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">Exercise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kenji Doya
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>