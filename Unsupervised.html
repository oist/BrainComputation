
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Chapter 5. Unsupervised Learning &#8212; Brain Computation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Unsupervised';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Unsupervised Learning: Exercise" href="Unsupervised_Exercise.html" />
    <link rel="prev" title="Chapter 4. Reinforcement Learning: Exercise" href="Reinforcement_Exercise.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="BrainComputation.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/BC_logo.png" class="logo__image only-light" alt="Brain Computation - Home"/>
    <script>document.write(`<img src="_static/BC_logo.png" class="logo__image only-dark" alt="Brain Computation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="BrainComputation.html">
                    Brain Computation: A Hands-on Guidebook
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Chapter 1. Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Neurons.html">Chapter 2. Neural Modeling and Analysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Neurons_Exercise.html">Chapter 2. Neural Modeling and Analysis: Exercise</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Supervised.html">Chapter 3: Supervised Learning</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Supervised_Exercise.html">Supervised Learning: Exercise</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Reinforcement.html">Chapter 4. Reinforcement Learning</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Reinforcement_Exercise.html">Chapter 4. Reinforcement Learning: Exercise</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">Chapter 5. Unsupervised Learning</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Unsupervised_Exercise.html">Unsupervised Learning: Exercise</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Bayesian.html">Chatper 6. Bayesian Approaches</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Bayesian_Exercise.html">Bayesian Approaches: Exercise</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Deep.html">Chapter 7: Deep Learning</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Deep_Exercise.html">Chapter 7: Deep Learning: Exercise</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Multiple.html">Chapter 8. Multiple Agents</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Multiple_Exercise.html">Chapter 8. Multiple Agents: Exercise</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Meta.html">Chapter 9. Meta-Learning</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Meta_Exercise.html">Chapter 9. Meta-Learning: Exercise</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Unsupervised.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 5. Unsupervised Learning</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contents">Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scikit-learn">scikit-learn</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-clustering">K-means Clustering</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mixtures-of-gaussians">Mixtures of Gaussians</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#expectation-maximization-em-algorithm">Expectation-Maximization (EM) Algorithm</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#e-expectation-step">E (expectation) step</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#m-maximization-step">M (maximization) step</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dirichlet-process-mixture">Dirichlet Process Mixture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hierarchical-clustering">Hierarchical clustering</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#principal-component-analysis">Principal Component Analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#singular-value-decomposition-svd">Singular value decomposition (SVD)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#online-pca">Online PCA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#infomax-principle">Infomax principle</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#independent-component-analysis-ica">Independent component analysis (ICA)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ica-by-infomax">ICA by Infomax</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#playing-sound">Playing sound</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#receptive-fields-of-visual-cortex-neurons">Receptive fields of visual cortex neurons</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#replicating-receptive-field-tuning">Replicating receptive field tuning</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#self-organization">Self Organization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pca">PCA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#infomax-and-ica">Infomax and ICA</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-5-unsupervised-learning">
<h1>Chapter 5. Unsupervised Learning<a class="headerlink" href="#chapter-5-unsupervised-learning" title="Link to this heading">#</a></h1>
<div class="math notranslate nohighlight">
\[ % Latex macros
\newcommand{\mat}[1]{\begin{pmatrix} #1 \end{pmatrix}}
\newcommand{\p}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\b}[1]{\boldsymbol{#1}}
\newcommand{\c}[1]{\mathcal{#1}}
\]</div>
<section id="contents">
<h2>Contents<a class="headerlink" href="#contents" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Clustering (Bishop, Chater 9):</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(k\)</span>-means clustering</p></li>
<li><p>mixtures of Gaussians</p></li>
<li><p>self-organizing maps (SOM)</p></li>
</ul>
</li>
<li><p>Subspace mapping (Biship, Chapter 12):</p>
<ul>
<li><p>principal component analysis (PCA)</p></li>
<li><p>singular value decomposition (SVD)</p></li>
<li><p>independent component analysis (ICA)</p></li>
</ul>
</li>
<li><p>Neural Mechanisms</p>
<ul>
<li><p>Receptive field formation</p></li>
</ul>
</li>
</ul>
<p>As we grow, we learn that there are different things and creatures in the world, such as plants and animals, and in more detail, dogs, cats and humans.
What is remarkable is that most of such learning is done spontaneously without explicit teaching about what is a dog, or labels specifying which is a dog or which is a cat.</p>
<p>Learning categories without explicit labels is an example of <em>unspervised learning</em>.</p>
<p>The key in unsupervised learning is to find a certain structure in the distribution of the observed data <span class="math notranslate nohighlight">\(\{\b{x}_1,...,\b{x}_N\}\)</span>, and come up with a probabilistic model <span class="math notranslate nohighlight">\(p(\b{x})\)</span> that produced the data.</p>
<p>Typical cases are:</p>
<ul class="simple">
<li><p>Dividing into clusters:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(k\)</span>-means clustering</p></li>
<li><p>mixtures of Gaussians</p></li>
<li><p>hierarchical clustering</p></li>
</ul>
</li>
<li><p>Decomposing into components:</p>
<ul>
<li><p>principal component analysis (PCA)</p></li>
<li><p>singular value decomposition (SVD)</p></li>
<li><p>independent component analysis (ICA)</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
</section>
<section id="scikit-learn">
<h2>scikit-learn<a class="headerlink" href="#scikit-learn" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="http://scikit-learn.org/stable/">scikit-learn</a> is a popular Pyhon libraries of supervised and unsupervised learning algorithms and sample datasets.</p>
<p>You can explore the algorithms in the tutorial:
<a class="reference external" href="http://scikit-learn.org/stable/tutorial/machine_learning_map">tutorials</a></p>
<p>Here we take a classic dataset <code class="docutils literal notranslate"><span class="pre">iris</span></code> from scikit-learn.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn</span><span class="w"> </span><span class="kn">import</span> <span class="n">datasets</span>
<span class="c1"># the iris dataset</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span>
<span class="c1">#print(iris.DESCR)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span>  <span class="c1"># flower features</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span>  <span class="c1"># flower class</span>
<span class="n">N</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
<span class="nb">print</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>150 4
</pre></div>
</div>
</div>
</div>
<p>Here is a visualization of the 4D data in 2D each.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">C</span><span class="p">);</span>  <span class="c1"># sepal length, width</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X[0]&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;X[1]&#39;</span><span class="p">);</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">C</span><span class="p">);</span>  <span class="c1"># petal length, width</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X[2]&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;X[3]&#39;</span><span class="p">);</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/369c4717fec53ac0be635c1779ad3d84d962000a968d425372f2875e90751e11.png" src="_images/369c4717fec53ac0be635c1779ad3d84d962000a968d425372f2875e90751e11.png" />
</div>
</div>
</section>
<section id="k-means-clustering">
<h2>K-means Clustering<a class="headerlink" href="#k-means-clustering" title="Link to this heading">#</a></h2>
<p>The most basic method of clustering is <em><span class="math notranslate nohighlight">\(K\)</span>-means clustering</em>,
which divides a data set <span class="math notranslate nohighlight">\(\{\b{x}_1,â€¦,\b{x}_N\}\)</span> into <span class="math notranslate nohighlight">\(K\)</span> clusters.</p>
<p>We define prototypes <span class="math notranslate nohighlight">\(\b{\mu}_k\)</span> for <span class="math notranslate nohighlight">\(k=1,...,K\)</span> clusters and specify belonging of data points by binary <em>indicator variables</em> <span class="math notranslate nohighlight">\(r_{nk}\in\{0,1\}\)</span>.</p>
<p>A good clustering is achieved by minimizing the <em>distortion measure</em></p>
<div class="math notranslate nohighlight">
\[ J = \sum_{n=1}^N \sum_{k=1}^K r_{nk}||\b{x}_n-\b{\mu}_k||^2. \]</div>
<p>which is a sum of distances of the data point from its prototype.</p>
<p>We do that by repeating the following steps:</p>
<ul class="simple">
<li><p>For the current prototypes <span class="math notranslate nohighlight">\(\b{\mu}_k\)</span>, re-assign each data point <span class="math notranslate nohighlight">\(\b{x}_n\)</span> by finding the nearest <span class="math notranslate nohighlight">\(\b{\mu}_k\)</span> and setting <span class="math notranslate nohighlight">\(r_{nk} = 1\)</span> and <span class="math notranslate nohighlight">\(r_{n j\ne k} = 0\)</span>.</p></li>
<li><p>For the current assignment by <span class="math notranslate nohighlight">\(r_{nk}\)</span>, update the prototypes by</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ \b{\mu}_k = \frac{\sum_{n=1}^N r_{nk}\b{x}_n}{\sum_{n=1}^N r_{nk}}\]</div>
<p>Here is a sample implementation of K-means.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">KMeans</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;K-Means clustering&quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;data: NxD data matrix</span>
<span class="sd">        K: number of clusters&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">data</span>  <span class="c1"># store dataset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># data dimensions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K</span> <span class="o">=</span> <span class="n">K</span>  <span class="c1"># number of clusters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>   <span class="c1"># cluster indices for data points</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>   <span class="c1"># indicator matrix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Mu</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="p">),:]</span>   <span class="c1"># pick K points randomly</span>
        
    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Re-assign to clusters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># clear the indicator variables</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
            <span class="c1"># check the distances</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="p">[</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Mu</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="p">)]</span>
            <span class="c1"># find the nearest mean</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>  <span class="c1"># new cluster assignment</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># new indicator variable</span>
        <span class="c1"># Update the means</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Mu</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span><span class="n">k</span><span class="p">]</span><span class="nd">@self</span><span class="o">.</span><span class="n">X</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span><span class="n">k</span><span class="p">])</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">imax</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;repeat until convergence&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">imax</span><span class="p">):</span>
            <span class="n">R0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1"># previous indicators</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="n">R0</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;converged with iteration&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">C</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Mu</span>
</pre></div>
</div>
</div>
</div>
<p>Try applying it to the last 2D of the iris dataset for easy visualization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># initialize the algorithm</span>
<span class="n">km</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:],</span> <span class="n">K</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">km</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">km</span><span class="o">.</span><span class="n">D</span><span class="p">,</span> <span class="n">km</span><span class="o">.</span><span class="n">K</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>150 2 3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># See step by step</span>
<span class="n">km</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<span class="c1">#print(km.C)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">km</span><span class="o">.</span><span class="n">C</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>  <span class="c1"># data colored by cluster</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">km</span><span class="o">.</span><span class="n">Mu</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">km</span><span class="o">.</span><span class="n">Mu</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">km</span><span class="o">.</span><span class="n">K</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">);</span>  <span class="c1"># means</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/190c61b366798247fe92678f1e5817e8f8607d35f861a78bd52302b11b79b03e.png" src="_images/190c61b366798247fe92678f1e5817e8f8607d35f861a78bd52302b11b79b03e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">km</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">2</span><span class="p">:],</span> <span class="n">K</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">up</span> <span class="o">=</span> <span class="mi">6</span>  <span class="c1"># updates</span>
<span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">up</span><span class="p">):</span>
    <span class="n">km</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">up</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span> <span class="n">u</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;update </span><span class="si">{</span><span class="n">u</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">km</span><span class="o">.</span><span class="n">C</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>  <span class="c1"># data colored by cluster</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">km</span><span class="o">.</span><span class="n">Mu</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">km</span><span class="o">.</span><span class="n">Mu</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">km</span><span class="o">.</span><span class="n">K</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>  <span class="c1"># means</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">km</span><span class="o">.</span><span class="n">C</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 2 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 1 2 2 2 2
 2 2 2 2 2 2 2 2 1 2 2 2 1 2 2 1 1 2 2 2 2 2 1 2 2 2 2 1 2 2 2 2 2 2 2 2 2
 2 2]
</pre></div>
</div>
<img alt="_images/656d49e37fa3caff466181e1dfa208c6204230193f1f56387702956a0a100fff.png" src="_images/656d49e37fa3caff466181e1dfa208c6204230193f1f56387702956a0a100fff.png" />
</div>
</div>
<p>Please try K smaller or larger than 3, or original 4D space.</p>
</section>
<section id="mixtures-of-gaussians">
<h2>Mixtures of Gaussians<a class="headerlink" href="#mixtures-of-gaussians" title="Link to this heading">#</a></h2>
<p>It is often the case that clusters have some overlaps and assignment is probabilistic. <em>Mixtures of Gaussians</em> is a probabilistic extention of <span class="math notranslate nohighlight">\(K\)</span>-means clustering.</p>
<p><em>Gaussian mixture distribution</em> has a form</p>
<div class="math notranslate nohighlight">
\[ p(\b{x}) = \sum_{k=1}^K \pi_{k} \mathcal{N}(\b{x};\b{\mu}_k, \Sigma_k) \]</div>
<p>where <span class="math notranslate nohighlight">\(\b{\mu}_k\)</span> and <span class="math notranslate nohighlight">\(\Sigma_k\)</span> are the mean vector and the covariance matrix of <span class="math notranslate nohighlight">\(k\)</span>-th Gaussian distribution and <span class="math notranslate nohighlight">\(\pi_k\)</span> is the mixture probability.</p>
<p>The probability density function (PDF) of a d-dimension Gaussian distribution is given by:</p>
<div class="math notranslate nohighlight">
\[ \mathcal{N}(\b{x};\b{\mu}, \Sigma) = 
\frac{1}{\sqrt{(2\pi)^d \det\Sigma}} \exp[-\frac{1}{2}(\b{x}-\b{\mu})^T\Sigma^{-1}(\b{x}-\b{\mu})].\]</div>
<p>Here we use the <code class="docutils literal notranslate"><span class="pre">multivariate_normal</span></code> function in scipy to visualize the PDF of a Mixture of Gaussians.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">multivariate_normal</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Probability density of a Mixture of Gaussians</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mixgauss_pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    <span class="n">K</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>  <span class="c1"># classes and data dimension</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">+=</span> <span class="n">pi</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">multivariate_normal</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">sigma</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">p</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pi</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]</span>    <span class="c1"># mixture probability</span>
<span class="n">mu</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>     <span class="c1"># means</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="p">[[[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]]</span>   <span class="c1"># variances</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">X0</span><span class="p">,</span> <span class="n">X1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">)</span>
<span class="n">P</span> <span class="o">=</span> <span class="n">mixgauss_pdf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">X0</span><span class="p">,</span><span class="n">X1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="n">pi</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span> <span class="n">X1</span><span class="p">,</span> <span class="n">P</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6b790ee111fcb576d979cb756a9e0249b422b194cda84cc28ae41828ef4f10f8.png" src="_images/6b790ee111fcb576d979cb756a9e0249b422b194cda84cc28ae41828ef4f10f8.png" />
</div>
</div>
<p>Let us generate data from this Mixture Gaussian.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sample from a Mixture Gaussian distribution</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mixgauss_sample</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">):</span>
    <span class="n">K</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">mu</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">sigma</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">k</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">X</span><span class="p">[</span><span class="n">n</span><span class="p">,:],</span> <span class="n">C</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">mixgauss_sample</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X0</span><span class="p">,</span> <span class="n">X1</span><span class="p">,</span> <span class="n">P</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ea471b00ad4fb66f16dc5369509d3ef61517645b36c7aae856b1d7d39015832f.png" src="_images/ea471b00ad4fb66f16dc5369509d3ef61517645b36c7aae856b1d7d39015832f.png" />
</div>
</div>
</section>
<section id="expectation-maximization-em-algorithm">
<h2>Expectation-Maximization (EM) Algorithm<a class="headerlink" href="#expectation-maximization-em-algorithm" title="Link to this heading">#</a></h2>
<p>For finding the parameters <span class="math notranslate nohighlight">\(\pi_k\)</span>, <span class="math notranslate nohighlight">\(\mu_k\)</span> and <span class="math notranslate nohighlight">\(\Sigma_k\)</span> <span class="math notranslate nohighlight">\((k=1,...,K)\)</span> for a give dataset, a standard way is to repeat the following steps, called the <em>expectation-maximization (EM)</em> algorithm:</p>
<section id="e-expectation-step">
<h3>E (expectation) step<a class="headerlink" href="#e-expectation-step" title="Link to this heading">#</a></h3>
<p>We consider a binary stochastic variable</p>
<div class="math notranslate nohighlight">
\[ \b{z}=(z_1,â€¦,z_K) \]</div>
<p>where <span class="math notranslate nohighlight">\(z_k\in\{0,1\}\)</span> and <span class="math notranslate nohighlight">\(\sum_{k=1}^K z_k=1\)</span>, indicating which Gaussian a data point belongs to.</p>
<p>For the current parameters <span class="math notranslate nohighlight">\((\pi_k,\mu_k\)</span>,<span class="math notranslate nohighlight">\(\Sigma_k)\)</span>, evaluate the posterior probability of <span class="math notranslate nohighlight">\(\b{z}\)</span> from the prior probability <span class="math notranslate nohighlight">\(\pi\)</span> and the likelihood for the data <span class="math notranslate nohighlight">\(\b{x}\)</span>, called <em>responsibility</em>:</p>
<div class="math notranslate nohighlight">
\[ r_{nk} = p(z_k=1|\b{x}_n) = \frac{\pi_k\c{N}(\b{x}_n|\b{\mu}_k,\Sigma_k)}{\sum_{j=1}^K \pi_j\c{N}(\b{x}_n|\b{\mu}_j,\Sigma_j)} \]</div>
</section>
<section id="m-maximization-step">
<h3>M (maximization) step<a class="headerlink" href="#m-maximization-step" title="Link to this heading">#</a></h3>
<p>For the current responsibility, update the parameters as the maximum likelihood estimate for the data weighted by the responsibility:</p>
<div class="math notranslate nohighlight">
\[ N_k = \sum_{n=1}^N r_{nk} \]</div>
<div class="math notranslate nohighlight">
\[ \pi_k = \frac{N_k}{N} \]</div>
<div class="math notranslate nohighlight">
\[ \b{\mu}_k = \frac{1}{N_k}\sum_{n=1}^N r_{nk}\b{x}_n \]</div>
<div class="math notranslate nohighlight">
\[ \Sigma_k = \frac{1}{N_k}\sum_{n=1}^N r_{nk}(\b{x}_n-\b{\mu}_k)(\b{x}_n-\b{\mu}_k)^T \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MixGauss</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;MixGauss: Mixture of Gaussians&quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">K</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;X: NxD data matrix</span>
<span class="sd">        K: number of Gaussians&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K</span> <span class="o">=</span> <span class="n">K</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">K</span>   <span class="c1"># cluster probability</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="p">))</span>   <span class="c1"># responsibility matrix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Mu</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="p">),:]</span>   <span class="c1"># pick K points randomly</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>   <span class="c1"># covariance for entire data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="p">)</span>   <span class="c1"># data probability for each cluster</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;EM update&quot;&quot;&quot;</span>
        <span class="c1"># Expectation step</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="p">):</span>
                <span class="n">pr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">multivariate_normal</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">Mu</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sig</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="c1"># responsibility</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="n">n</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">pr</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">pr</span><span class="p">)</span>    <span class="c1"># responsibility p(z)</span>
        <span class="c1"># Maximization step</span>
        <span class="n">num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>    <span class="c1"># effective numbers for each class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Pi</span> <span class="o">=</span> <span class="n">num</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span>    <span class="c1"># class prior</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Mu</span><span class="p">[</span><span class="n">k</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">num</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">dX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Mu</span><span class="p">[</span><span class="n">k</span><span class="p">,:]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Sig</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="n">num</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">dX</span><span class="o">.</span><span class="n">T</span><span class="nd">@dX</span>  <span class="c1"># cluster covariance    </span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">imax</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">conv</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;repeat until convergence&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">imax</span><span class="p">):</span>
            <span class="n">R0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
            <span class="c1">#print(self.R, R0)</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="o">-</span><span class="n">R0</span><span class="p">))</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">&lt;</span> <span class="n">conv</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;converged with iteration&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Mu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Sig</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mg</span> <span class="o">=</span> <span class="n">MixGauss</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mg</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<span class="c1">#print(&quot;mu =&quot;, mg.Mu, &quot;\nsig = &quot;, mg.Sig)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mg</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">mg</span><span class="o">.</span><span class="n">K</span><span class="p">)),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">mg</span><span class="o">.</span><span class="n">Mu</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">mg</span><span class="o">.</span><span class="n">Mu</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">mg</span><span class="o">.</span><span class="n">K</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">);</span>  <span class="c1"># means</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d97ecd6fec4f20cfd98757e44d488b310112b9138fae3a037a92741ad6513d62.png" src="_images/d97ecd6fec4f20cfd98757e44d488b310112b9138fae3a037a92741ad6513d62.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mg</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mg</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">mg</span><span class="o">.</span><span class="n">K</span><span class="p">)),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">mg</span><span class="o">.</span><span class="n">Mu</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">mg</span><span class="o">.</span><span class="n">Mu</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">mg</span><span class="o">.</span><span class="n">K</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">);</span>  <span class="c1"># means</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>converged with iteration 20
</pre></div>
</div>
<img alt="_images/b151f9fa937a98e378a6beaeb42232aeea66b926ba806fe2991bd1039090ee39.png" src="_images/b151f9fa937a98e378a6beaeb42232aeea66b926ba806fe2991bd1039090ee39.png" />
</div>
</div>
<p>Let us try with the iris dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span>  <span class="c1"># flower features</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span>  <span class="c1"># flower class</span>
<span class="n">mg</span> <span class="o">=</span> <span class="n">MixGauss</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mg</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mg</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">mg</span><span class="o">.</span><span class="n">K</span><span class="p">)),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">mg</span><span class="o">.</span><span class="n">Mu</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">mg</span><span class="o">.</span><span class="n">Mu</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">mg</span><span class="o">.</span><span class="n">K</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">);</span>  <span class="c1"># means</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/70f13f5c9bc6626a2c883545405814653c71bed82a8cad95db61e7f70dd0e0fa.png" src="_images/70f13f5c9bc6626a2c883545405814653c71bed82a8cad95db61e7f70dd0e0fa.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mg</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mg</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">mg</span><span class="o">.</span><span class="n">K</span><span class="p">)),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">mg</span><span class="o">.</span><span class="n">Mu</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">mg</span><span class="o">.</span><span class="n">Mu</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">mg</span><span class="o">.</span><span class="n">K</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">);</span>  <span class="c1"># means</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>converged with iteration 61
</pre></div>
</div>
<img alt="_images/a553634df5f542769f0b8f870221f18510c62d117b03878dd98c46f2ef70b0b1.png" src="_images/a553634df5f542769f0b8f870221f18510c62d117b03878dd98c46f2ef70b0b1.png" />
</div>
</div>
</section>
</section>
<section id="dirichlet-process-mixture">
<h2>Dirichlet Process Mixture<a class="headerlink" href="#dirichlet-process-mixture" title="Link to this heading">#</a></h2>
<p>One problem in <span class="math notranslate nohighlight">\(K\)</span>-means and Mixture of Gaussians is that you have to assume the number of clusters <span class="math notranslate nohighlight">\(K\)</span> beforehand.</p>
<p>There is an extension called <em>Dirichlet process mixture</em> that decides the number of clusters based on the data. See Kevin Murphy (2012) Ch. 25.2 for details.</p>
<p>It is available from scikit-learn as <code class="docutils literal notranslate"><span class="pre">mixture.BayesianGaussianMixture</span></code></p>
</section>
<section id="hierarchical-clustering">
<h2>Hierarchical clustering<a class="headerlink" href="#hierarchical-clustering" title="Link to this heading">#</a></h2>
<p>Another popular clustering algorithm is hierarchical clustering, which makes a cluster by the closest pair and gradually grow clusters. The results are often shown by a <em>dendrogram</em>*.</p>
<p>These are available in scipy as <code class="docutils literal notranslate"><span class="pre">cluster.hierarchy</span></code>.</p>
</section>
<section id="principal-component-analysis">
<h2>Principal Component Analysis<a class="headerlink" href="#principal-component-analysis" title="Link to this heading">#</a></h2>
<p>Grasping the distribution of a high-dimensional data is not easy for human eyes. We often try to find a low-dimensional projection of the data that characteirizes the distribution.</p>
<p><em>Principal componet analysis (PCA)</em> finds the directions of the data distribution with the largest variance.</p>
<p>Consider a projection of <span class="math notranslate nohighlight">\(D\)</span>-dimensional vector <span class="math notranslate nohighlight">\(\b{x} = (x_1,...,x_D)^T\)</span> to
<span class="math notranslate nohighlight">\(M\)</span>-dimensional vector <span class="math notranslate nohighlight">\(\b{y} = (y_1,...,y_M)^T\)</span> by</p>
<div class="math notranslate nohighlight">
\[ \b{y} = V \b{x} \]</div>
<p>where <span class="math notranslate nohighlight">\(V = (\b{v}_1,...,\b{v}_M)^T \in\mathbb{R}^{M\times D}\)</span>, <span class="math notranslate nohighlight">\(||\b{v}_m||=1\)</span>.</p>
<p>For a data set <span class="math notranslate nohighlight">\(X=(x_1,...,x_N)^T\in\mathbb{R}^{N\times D}\)</span> with zero mean (mean subtracted),
we try to find the projection by <span class="math notranslate nohighlight">\(V\)</span> that make the variance of <span class="math notranslate nohighlight">\(\b{y}\)</span> the largest.</p>
<p>Using the covariance matrix of the original data</p>
<div class="math notranslate nohighlight">
\[ C = \frac{1}{N}X^T X = \frac{1}{N}\sum_{n=1}^N \b{x}_n\b{x}_n^T \in\mathbb{R}^{D\times D}\]</div>
<p>the covariance matrix of the projected data <span class="math notranslate nohighlight">\(Y=X V^T\)</span> is given as</p>
<div class="math notranslate nohighlight">
\[ \frac{1}{N}Y^T Y = \frac{1}{N}V X^T X V^T = V C V^T\in\mathbb{R}^{M\times M}.\]</div>
<p>The variance of projected data is maximized by solving the eigenvalue problem <span class="math notranslate nohighlight">\(C\b{v}=\lambda \b{v}\)</span> and setting the projection matrix
<span class="math notranslate nohighlight">\(V=(\b{v}_1,...,\b{v}_M)^T\)</span> made of the eigenvectors with the largest eigenvalues <span class="math notranslate nohighlight">\(\lambda_1,...,\lambda_M\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sklearn.datasets offers a wide range of public datasets</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn</span><span class="w"> </span><span class="kn">import</span> <span class="n">datasets</span>
<span class="c1"># the iris dataset</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span>  <span class="c1"># flower features</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span>  <span class="c1"># flower types</span>
<span class="n">N</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
<span class="nb">print</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>150 4
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the data in 3D</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mpl_toolkits.mplot3d</span><span class="w"> </span><span class="kn">import</span> <span class="n">Axes3D</span> <span class="c1"># for 3D plotting</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">T</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f827478bb7044dba24c01021856ccec3c0732fcecc47e1426b0e0dd97baab335.png" src="_images/f827478bb7044dba24c01021856ccec3c0732fcecc47e1426b0e0dd97baab335.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data covariance</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># subtract the mean</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="nd">@X</span><span class="o">/</span><span class="n">N</span>
<span class="c1"># eigenvalue L[i] and normal eigenvector V[:,i]</span>
<span class="n">L</span><span class="p">,</span> <span class="n">Vt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span> <span class="n">C</span><span class="p">)</span>   <span class="c1"># for symmetric matrix</span>
<span class="c1">#L, V = linalg.eig( C)</span>
<span class="c1"># in matrix form: C*V=V*L, i.e. C=V*L*V&#39; from V&#39;*V=I</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>   <span class="c1"># eigenvalues</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Vt</span><span class="p">)</span>   <span class="c1"># columns are eigenvectors</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.02367619 0.0776881  0.24105294 4.20005343]
[[ 0.31548719  0.58202985  0.65658877 -0.36138659]
 [-0.3197231  -0.59791083  0.73016143  0.08452251]
 [-0.47983899 -0.07623608 -0.17337266 -0.85667061]
 [ 0.75365743 -0.54583143 -0.07548102 -0.3582892 ]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="o">-</span><span class="n">L</span><span class="p">)</span>  <span class="c1"># largest first</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>  <span class="c1"># reorder</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">Vt</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>  
<span class="nb">print</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;index m&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\lambda_m$&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-0.36138659  0.08452251 -0.85667061 -0.3582892 ]
 [ 0.65658877  0.73016143 -0.17337266 -0.07548102]
 [ 0.58202985 -0.59791083 -0.07623608 -0.54583143]
 [ 0.31548719 -0.3197231  -0.47983899  0.75365743]]
</pre></div>
</div>
<img alt="_images/217c06ea94bd7584799078114c633ee22ace9fc87a95b71862931c4423925faf.png" src="_images/217c06ea94bd7584799078114c633ee22ace9fc87a95b71862931c4423925faf.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Projection of data to the PC space</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">X</span><span class="nd">@V</span><span class="o">.</span><span class="n">T</span>
<span class="c1"># First two PC</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Z</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">Z</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">T</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3f806a97e498f4b97b32e2f127f8ec37ed657ba7530f26c8be4e8e1809a67138.png" src="_images/3f806a97e498f4b97b32e2f127f8ec37ed657ba7530f26c8be4e8e1809a67138.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Last two PC</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Z</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span> <span class="n">Z</span><span class="p">[:,</span><span class="mi">3</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">T</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ce6f96cdbfed753fd77bca84dfbd230889a94d333985b818436ae713cdf4df8c.png" src="_images/ce6f96cdbfed753fd77bca84dfbd230889a94d333985b818436ae713cdf4df8c.png" />
</div>
</div>
</section>
<section id="singular-value-decomposition-svd">
<h2>Singular value decomposition (SVD)<a class="headerlink" href="#singular-value-decomposition-svd" title="Link to this heading">#</a></h2>
<p>Singular value decomposition (SVD) tries to represent a <span class="math notranslate nohighlight">\(N\times D\)</span> matrix (<span class="math notranslate nohighlight">\(N&gt;D\)</span>) by a weighted sum of products of column vectors <span class="math notranslate nohighlight">\(\b{u}_i \in\mathbb{R}^N\)</span> and row vectors <span class="math notranslate nohighlight">\(\b{v}_i^T \in\mathbb{R}^D\)</span>.
For example, data may be a mixture of specific patterns <span class="math notranslate nohighlight">\(\b{v}_i\)</span> following certain time courses <span class="math notranslate nohighlight">\(\b{u}_i\)</span>.</p>
<p>The decomposition is represented as</p>
<div class="math notranslate nohighlight">
\[ X = \sum_{i=1}^D s_i \b{u}_i \b{v}_i^T = U S V^T\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[ U = (\b{u}_1,...,\b{u}_D) \in\mathbb{R}^{N\times D} \]</div>
<div class="math notranslate nohighlight">
\[ S = \mbox{diag}(s_1,...,s_D) \in\mathbb{R}^{D\times D} \]</div>
<div class="math notranslate nohighlight">
\[ V = (\b{v}_1,...,\b{v}_D) \in\mathbb{R}^{D\times D}. \]</div>
<p>This decomposition is achieved by selecting <span class="math notranslate nohighlight">\(\b{v}_i\)</span> as the eigenvectors of <span class="math notranslate nohighlight">\(X^T X\)</span> and <span class="math notranslate nohighlight">\(s_i= \sqrt{\lambda_i}\)</span> by their corresponding eigenvalues (<span class="math notranslate nohighlight">\(\lambda_1 \ge ... \ge\lambda_D\)</span>).</p>
<p>Because <span class="math notranslate nohighlight">\(V\)</span> is the same as that for PCA, the SVD algorithm can also be used for PCA.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># X = U*S*V&#39; where S is a diagonal matrix</span>
<span class="c1"># i.e. C = X&#39;*X/N = V*S^2/N*V&#39;</span>
<span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Vs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="c1"># See if they match those derived from covariance matrix</span>
<span class="nb">print</span><span class="p">(</span><span class="n">S</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Vs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4.20005343 0.24105294 0.0776881  0.02367619]
[4.20005343 0.24105294 0.0776881  0.02367619]
[[ 0.36138659 -0.08452251  0.85667061  0.3582892 ]
 [-0.65658877 -0.73016143  0.17337266  0.07548102]
 [ 0.58202985 -0.59791083 -0.07623608 -0.54583143]
 [ 0.31548719 -0.3197231  -0.47983899  0.75365743]]
[[-0.36138659  0.08452251 -0.85667061 -0.3582892 ]
 [ 0.65658877  0.73016143 -0.17337266 -0.07548102]
 [ 0.58202985 -0.59791083 -0.07623608 -0.54583143]
 [ 0.31548719 -0.3197231  -0.47983899  0.75365743]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="online-pca">
<h2>Online PCA<a class="headerlink" href="#online-pca" title="Link to this heading">#</a></h2>
<p>It has been shown that a simple linear neural network can perform computation similar to PCA (Sanger 1989).</p>
<p>Let us consider a two-layer network</p>
<div class="math notranslate nohighlight">
\[ \b{y} = W \b{x} \]</div>
<p>with input <span class="math notranslate nohighlight">\(\b{x}=(x_1,...,x_D)^T\)</span>, output <span class="math notranslate nohighlight">\(\b{y}=(y_1,...,y_M)^T\)</span>, and <span class="math notranslate nohighlight">\(M\times D\)</span> connection weights <span class="math notranslate nohighlight">\(W\)</span> (<span class="math notranslate nohighlight">\(M&lt;D\)</span>).</p>
<p>The <em>generalized Hebbian algorithm</em> considers an ordered suppression of the input by the components already captured by other units.</p>
<p>In a componet form, it is represented as</p>
<div class="math notranslate nohighlight">
\[ \Delta w_{ij} = \alpha(y_i x_j - y_i\sum_{k\le i} w_{kj}y_k) \]</div>
<div class="math notranslate nohighlight">
\[ = \alpha[y_i(x_j - \sum_{k&lt;i} w_{kj}y_k) - y_i^2 w_{ij}] \]</div>
<p>In a matrix form, it is represented as</p>
<div class="math notranslate nohighlight">
\[ \Delta W = \alpha(\b{y}\b{x}^T - LT[\b{y}\b{y}^T]W) \]</div>
<p>where <span class="math notranslate nohighlight">\(LT[\ ]\)</span> takes the lower triangle (including the diagonal) of a matrix.</p>
<p>It has been shown that the rows of matrix <span class="math notranslate nohighlight">\(W\)</span> converges to the <span class="math notranslate nohighlight">\(M\)</span> eigenvectors with the largest eigen values of the covariance matrix <span class="math notranslate nohighlight">\(E[\b{x}\b{x}^T ]\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">gha</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generalized Hebbian Alogrithm by Sanger (1989)&quot;&quot;&quot;</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">W</span><span class="nd">@X</span><span class="p">[</span><span class="n">n</span><span class="p">,:]</span>
        <span class="n">W</span> <span class="o">+=</span> <span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">[</span><span class="n">n</span><span class="p">,:])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">tril</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">y</span><span class="p">))</span><span class="nd">@W</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">W</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Iris example</span>
<span class="n">M</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">D</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">D</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">gha</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 0.39112097 -0.01374821  0.8332874   0.39267377]
 [ 0.57061998  0.20773716  0.2250268  -0.37771495]]
[[ 0.39271666 -0.01236849  0.83328755  0.39109805]
 [ 0.50439802  0.23000146  0.12868467 -0.293473  ]]
[[ 0.39271995 -0.01236553  0.83328722  0.39109549]
 [ 0.51077947  0.27819592  0.07122278 -0.25887125]]
[[ 0.39271996 -0.01236553  0.83328722  0.39109549]
 [ 0.54133441  0.33987093  0.02443311 -0.23753567]]
[[ 0.39271996 -0.01236553  0.83328722  0.39109549]
 [ 0.57974395  0.40802837 -0.01755144 -0.21955903]]
[[ 0.39271996 -0.01236553  0.83328722  0.39109549]
 [ 0.61588885  0.47520918 -0.05515706 -0.20128897]]
[[ 0.39271996 -0.01236553  0.83328722  0.39109549]
 [ 0.64352887  0.53468188 -0.08718675 -0.18202017]]
[[ 0.39271996 -0.01236553  0.83328722  0.39109549]
 [ 0.66069061  0.58262448 -0.11272858 -0.16263176]]
[[ 0.39271996 -0.01236553  0.83328722  0.39109549]
 [ 0.66876701  0.61866276 -0.13190516 -0.1444115 ]]
[[ 0.39271996 -0.01236553  0.83328722  0.39109549]
 [ 0.67056933  0.64463557 -0.14566594 -0.12829027]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">W</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.39238556, -0.012355  ,  0.83257769,  0.39076248],
       [ 0.70570795,  0.67841524, -0.15329901, -0.13501283]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Projection of data to the PC space</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">X</span><span class="nd">@W</span><span class="o">.</span><span class="n">T</span>
<span class="c1"># First two PC</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Z</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">Z</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">T</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ea372988ece388f18f2d9c073a2f6172823c905e4a0d501a051e1d15a03c6a8e.png" src="_images/ea372988ece388f18f2d9c073a2f6172823c905e4a0d501a051e1d15a03c6a8e.png" />
</div>
</div>
</section>
<section id="infomax-principle">
<h2>Infomax principle<a class="headerlink" href="#infomax-principle" title="Link to this heading">#</a></h2>
<p>The <em>infomax</em> principle is to find a mapping from input <span class="math notranslate nohighlight">\(\b{x}\)</span> to the output <span class="math notranslate nohighlight">\(\b{y}\)</span> so that the mutual information</p>
<div class="math notranslate nohighlight">
\[ I(\b{y};\b{x}) = H(\b{y}) â€“ H(\b{y}|\b{x}) \]</div>
<p>is maximized.</p>
<p>PCA is an example of infomax by a linear transformation</p>
<div class="math notranslate nohighlight">
\[\b{y}=V\b{x} \]</div>
<p>while keeping the norm of the row vectors of matrix <span class="math notranslate nohighlight">\(V\)</span> to be one.</p>
<p>For a deterministic mapping or a mapping with homogenetous additive noise</p>
<div class="math notranslate nohighlight">
\[ \b{y}=f(\b{x})+\b{\epsilon}, \]</div>
<p><span class="math notranslate nohighlight">\(H(\b{y}|\b{x})\)</span> is constant, so that</p>
<ul class="simple">
<li><p>maximization of information transfer <span class="math notranslate nohighlight">\(I(\b{y};\b{x})\)</span></p></li>
</ul>
<p>is equivalent to</p>
<ul class="simple">
<li><p>maximization of output entropy <span class="math notranslate nohighlight">\(H(\b{y})\)</span>.</p></li>
</ul>
<p>Note that <span class="math notranslate nohighlight">\(H(\b{y})\le\sum_i H(y_i)\)</span>
and the equality is achieved when the output components are independent: <span class="math notranslate nohighlight">\(p(\b{y}) = \prod_i p(y_i).\)</span></p>
</section>
<section id="independent-component-analysis-ica">
<h2>Independent component analysis (ICA)<a class="headerlink" href="#independent-component-analysis-ica" title="Link to this heading">#</a></h2>
<p>We can listen to a particular speakerâ€™s voice or a sound of an instrument among mixed sound.
This is called <em>cocktail party effect</em> or <em>blind separation</em>.</p>
<p>For a <span class="math notranslate nohighlight">\(D\)</span> independent signal sources <span class="math notranslate nohighlight">\(\b{s}=(s_1,...,s_D)^T\)</span>, we consider mixture signal</p>
<div class="math notranslate nohighlight">
\[ x_j = \sum_{i=1}^D a_{ji} s_i, \]</div>
<p>or in vector form</p>
<div class="math notranslate nohighlight">
\[ \b{x} = A \b{s}. \]</div>
<p><em>Independent component analysis (ICA)</em> tries to recover the original signals by</p>
<div class="math notranslate nohighlight">
\[ \b{y} = W\b{x} \]</div>
<p>where components of <span class="math notranslate nohighlight">\(\b{y}=(y_1,...,y_D)\)</span> are independent, i.e.,</p>
<div class="math notranslate nohighlight">
\[ p(\b{y}) = \prod_{i=1}^D p(y_i), \]</div>
<p>When the amplitude of <span class="math notranslate nohighlight">\(y_i\)</span> is bounded,
the output entropy <span class="math notranslate nohighlight">\(H(\b{y})\le\sum_i H(y_i)\)</span> is maximized when <span class="math notranslate nohighlight">\(y_i\)</span> are independent.</p>
<section id="ica-by-infomax">
<h3>ICA by Infomax<a class="headerlink" href="#ica-by-infomax" title="Link to this heading">#</a></h3>
<p>If the signal distribution <span class="math notranslate nohighlight">\(p(s_i)\)</span> is <em>supragaussian</em>, having a sharp peak and long tails, ICA is achieved by a network with saturating output function, such as</p>
<div class="math notranslate nohighlight">
\[ \b{u} = W \b{x} \]</div>
<div class="math notranslate nohighlight">
\[ y_i = \tanh(u_i). \]</div>
<p>where <span class="math notranslate nohighlight">\(\tanh(u)=\frac{e^u-e^{-u}}{e^u+e^{-u}}\)</span> is a sigmoid function within <span class="math notranslate nohighlight">\((-1,1)\)</span>.</p>
<p>In this case, the derivative of the output entropy is given by (Bell &amp; Sejnowski 1995)</p>
<div class="math notranslate nohighlight">
\[ \p{H(\b{y})}{W} = {W^T}^{-1} + \b{y}\b{x}^T. \]</div>
<p>The entropy is maximized by the <em>natural gradient</em> method (Amari 1998),</p>
<div class="math notranslate nohighlight">
\[ \Delta W = \alpha \p{H(\b{y})}{W} W^TW \]</div>
<div class="math notranslate nohighlight">
\[ = \alpha({W^T}^{-1} - \b{y}\b{x}^T) W^TW \]</div>
<div class="math notranslate nohighlight">
\[ = \alpha(W-\b{y}\b{u}^TW). \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">ica</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">W</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">online</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ICA by max entropy with tanh()&quot;&quot;&quot;</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">if</span> <span class="n">W</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>  <span class="c1"># initial guess</span>
    <span class="k">if</span> <span class="n">online</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="n">u</span> <span class="o">=</span> <span class="n">W</span><span class="nd">@X</span><span class="p">[</span><span class="n">n</span><span class="p">,:]</span>  
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
            <span class="n">W</span> <span class="o">+=</span> <span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">W</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">u</span><span class="nd">@W</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># batch update</span>
        <span class="n">U</span> <span class="o">=</span> <span class="n">X</span><span class="nd">@W</span><span class="o">.</span><span class="n">T</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
        <span class="n">W</span> <span class="o">+=</span> <span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">W</span> <span class="o">-</span> <span class="n">Y</span><span class="o">.</span><span class="n">T</span><span class="nd">@U@W</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">W</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make mixed signals of two decaying tones</span>
<span class="n">D</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># channels</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">2000</span>  <span class="c1"># signal length</span>
<span class="c1"># Source signal</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">D</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">D</span><span class="p">):</span>
    <span class="n">T</span> <span class="o">=</span> <span class="mi">200</span>  <span class="c1"># tone length</span>
    <span class="n">M</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># number of tones</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">/</span><span class="mi">50</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>  <span class="c1"># single tone</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="n">T</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>  <span class="c1"># start timing</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
        <span class="n">S</span><span class="p">[</span><span class="n">ts</span><span class="p">[</span><span class="n">m</span><span class="p">]:</span><span class="n">ts</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">+</span><span class="n">T</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">s</span>  <span class="c1"># add shifted tone</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">);</span>
<span class="c1"># Mixed signal</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">D</span><span class="p">,</span><span class="n">D</span><span class="p">))</span>   <span class="c1"># random matrix</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">S</span><span class="nd">@A</span><span class="o">.</span><span class="n">T</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.16343033 0.17659611]
 [0.72347376 0.59690032]]
</pre></div>
</div>
<img alt="_images/a08d82b900f7367060658886d91d689989eb7381aa82b631d1424ff616f69ba1.png" src="_images/a08d82b900f7367060658886d91d689989eb7381aa82b631d1424ff616f69ba1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Applyy ICA to the mixture</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">ica</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">W</span><span class="nd">@A</span><span class="p">)</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">X</span><span class="nd">@W</span><span class="o">.</span><span class="n">T</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.42405706 0.64765335]
 [3.23808511 2.64508877]]
[[-1.36885246  0.92258221]
 [ 5.24935003  4.19173605]]
[[-3.85178702  3.67072094]
 [ 6.3449311   3.84372715]]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-2.25352577  5.99208737]
 [ 8.35354439  1.5925545 ]]
[[-0.03895364  6.96907908]
 [ 9.47298103  0.05998429]]
[[0.01861023 7.07989167]
 [9.6459177  0.02484051]]
[[0.01945641 7.09206897]
 [9.66500704 0.02449817]]
[[0.01949892 7.09338911]
 [9.66707728 0.02449247]]
[[0.01950311 7.093532  ]
 [9.66730137 0.02449212]]
[[0.01950356 7.09354746]
 [9.66732562 0.02449208]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the original and separated signals</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;U&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1c7010f9741b5ca4412b01e482bef0a0d1bd692a607154267f6f4bcc296c0b76.png" src="_images/1c7010f9741b5ca4412b01e482bef0a0d1bd692a607154267f6f4bcc296c0b76.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot t2D signal distributions</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">S</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">S</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">U</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">U</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;U&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Y</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">Y</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6b8c4a1181eebcc0b8116e751cd90757a7c7a4030535418b29c8f8d6ca9e9018.png" src="_images/6b8c4a1181eebcc0b8116e751cd90757a7c7a4030535418b29c8f8d6ca9e9018.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># see how the mixing and separation weights are aligned to mixed data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="c1"># estimated mixing vectors</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="c1"># separating vectors</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7c92316277f4c77735bb4bc6e583934763a2002242644ace510d79d83e43573f.png" src="_images/7c92316277f4c77735bb4bc6e583934763a2002242644ace510d79d83e43573f.png" />
</div>
</div>
</section>
</section>
<section id="playing-sound">
<h2>Playing sound<a class="headerlink" href="#playing-sound" title="Link to this heading">#</a></h2>
<p>Do you want to hear the mixed and separated sounds?</p>
<p>You can use IPython.display library to play sound.<br />
<a class="reference external" href="https://ipython.readthedocs.io/en/stable/api/generated/IPython.display.html">https://ipython.readthedocs.io/en/stable/api/generated/IPython.display.html</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ipd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Source sounds</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">D</span><span class="p">):</span>
    <span class="n">ipd</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">ipd</span><span class="o">.</span><span class="n">Audio</span><span class="p">(</span><span class="n">S</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="n">rate</span><span class="o">=</span><span class="mi">4000</span><span class="p">))</span>  <span class="c1"># 4kHz sampling</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
                <audio  controls="controls" >
                    <source src="data:audio/wav;base64,UklGRsQPAABXQVZFZm10IBAAAAABAAEAoA8AAEAfAAACABAAZGF0YaAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeknUTdYLxMG0su3p4TIbS6oeU9iCuGba3ByyQuoqYe0Lw1PRIQn/f81+VAstksmAxuJEW8F8cyw5tzSICsfDNrxwy0Jv2gmY+bV6FeBdzE5F+Sqtuq6B+TRHqlEVErLEz68K5G4vG00ZJCjcWbd91cYYFkNBL5nxWMOXzeIEmzUXNKsD19GVy9X0iCaLM5MRGOFhziLpdBfRLg0bre+31NfhpAkwJz8ggfxQ3Z/e+f3sHaQh4wb55t/e9vQiFO8few6o8Nbhy+7BCu0bPxOP+a/mYOt6AnEWYxUXAZzsaerE+0EQShXuBuPydOvW9ggKbxPyCuz4/O25800EWxAwDUL+fPFM8nD/kQzbDZkCcvVS8qf7igg4Dc0Fcfl78wv5qASfC9UHIv1w9ZH3NwFkCccIRgDc9x33af7aBsoIuQJx+n/3VfxJBBAIbATw/IL4AfvoAdIGZAUo/+35Yfri/0YFtAX4AI37W/pM/p4DeQVRAjP9zvox/QMC1QSqTI9MbgdRvkqz2+17NiVLPxsX1gS4BtwOH3VDnSlE6w7CT9IeC603SjCo/R/Pes6D+sQpgzFRDOfess+k7OcZCi7gFw/t/9Sm5FgMWyfTHcf5wdyl4KcA0R4DIEwEzOUd4Gf3hxURHzgMGe9b4tjwbQy6G24R0/eY5vLsOgTJFhMUX/8M7Hnrbv0AEXoUWwUA8gbsS/gHCxYTnwna9yDu5vRpBWcQLAwj/UXxJ/OKAOsMKg2HAfn02vKr/BoJ2AzcBM/4tvPm+VcFhgsSB2z8avU6+O8BhQk5CJH/o/eQ9xn/JwdxCBICFfq+9/H8sQTpB98DgPyT+H/7XQLVBvcEsv7Z+b36VgBqBWkFhwBd+5X6t/7YA08F7QHx/On6jP1KAskE3gJx/pf71fzgAPoDXgPA/3/8ifyy/wIDewPLAID9l/zK/v4BRwOOAYD+6/wt/gcB2AIGAmn/b/3Z/S8ARAI5AiwADf7F/YL/nwExAsMAtP7k/QT/+wD9ASkBU/8q/rb+ZQCpAWAB3v+J/gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHpJ1E3WC8TBtLLt6eEyG0uqHlPYgrhm2twcskLqKmHtC8NT0SEJhDb4MH7/adAVztr4YyimMckN596yz6Ts5xkKLuAXD+3/1KbkWAxbJ9Mdx/nB3KXgpwDRHgMgTATM5R3gZ/eHFREfOAwZ71vi2PBtDLobbhHT95jm8uw6BMkWExRf/wzseetu/QARehRbBQDyBuxL+AcLFhOfCdr3IO7m9GkFZxAsDCP9RfEn84oA6wwqDYcB+fTa8qv8GgnYDNwEz/i28+b5VwWGCxIHbPxq9Tr47wGFCTkIkf+j95D3Gf8nB3EIEgIV+r738fyxBOkH3wOA/JP4f/tdAtUG9wSy/tn5vfpWAGoFaQWHAF37lfq3/tgDTwXtAfH86fqM/UoCyQTeAnH+l/vV/OAA+gNeA8D/f/yJ/LL/AgN7A8sAgP2X/Mr+/gFHA44BgP7r/C3+BwHYAgYCaf9v/dn9LwBEAjkCLAAN/sX9gv+fATECwwC0/uT9BP/7AHdL/U4oC+6/arFS6oo0fEyHHtvWgrhm2twcskLqKmHtC8NT0SEJhDb4MH7/adAVztr4YyimMckN596yz6Ts5xkKLuAXD+3/1KbkWAxbJ9Mdx/nB3KXgpwDRHgMgTATM5R3gZ/eHFREfOAwZ71vi2PBtDLobbhHT95jm8uw6BMkWExRf/wzseetu/QARehRbBQDyBuxL+AcLFhOfCdr3IO7m9GkFZxAsDCP9RfEn84oA6wwqDYcB+fTa8qv8GgnYDNwEz/i28+b5VwWGCxIHbPxq9Tr47wGFCTkIkf+j95D3Gf8nB3EIEgIV+r738fyxBOkH3wOA/JP4f/tdAtUG9wSy/tn5vfpWAGoFaQWHAF37lfq3/tgDTwXtAfH86fqM/UoCyQTeAnH+l/vV/OAA+gNeA8D/f/yJ/LL/AgN7A8sAgP2X/Mr+/gFHA44BgP7r/C3+BwHYAgYCaf9v/dn9LwBEAjkCLAAN/sX9gv+fATECwwC0/uT9BP/7AP0BKQFT/yr+tv5lAKkBYAHe/4n+AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB6SdRN1gvEwbSy7enhMhtLqh5T2PwBOiizKHUEn91N1+z1bhzLJ9YOe+nk2UbtxxDDI8MVsfQc3wjoNgacHWUZdP725enlYv1LFiIaQQaG7WrmqPavDogY4AsD9fPoJfJ4BzoVTg/S+97swO8sAdsQuhCFAYvxOe8f/AIMchBcT0FEDfw8uue5yPi0OyxG9xCNzlK7xOZCJ9RBASCo4irCs9rmE+s4Kins9LbMUtQDAygt8Cw1BEnZ89J79SQgJyzjD2jmoNW16zgT2ie/F93yRdu35XMHJSHzG8P9xuIy45P9GhnsHIQGHeue4wH2rhBGG9wMa/NR5uPwqgi0F8cQAPuV6h/uowHqEnYSYQG673Dt+fuSDT4SSQYh9XLu2vc8CI0QnglK+rXwS/VZA9YNcAvT/sPzLPQ7/4wK6gt8AjD3RvQN/BUHTAspBZ36VvXi+cMD3gnVBsP9EPev+NYA6weUB2sAKvlb+Hn+ugWJB3sCY/u7+Lz8hgPfBuQDhv2j+aT7fwHGBa4Eaf/h+pL84f8qA3kDogBX/ZL87f4oAlED3gJx/pf71fzgAPoDXgPA/3/8ifyy/wIDewPLAID9l/zK/v4BRwOOAYD+6/wt/gcB2AIGAmn/b/3Z/S8ARAI5AiwADf7F/YL/nwExAsMAtP7k/QT/+wD9ASkBU/8q/rb+ZQCpAWAB3v+J/gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHpJ1E3WC8TBtLLt6eEyG0uqHlPYgrhm2twcskLqKmHtC8NT0SEJhDb4MH7/adAVztr4YyimMckN596yz6Ts5xkKLuAXD+3/1KbkWAxbJ9Mdx/nB3KXgpwDRHgMgTATM5R3gZ/eHFREfOAwZ71vi2PBtDLobbhHT95jm8uw6BMkWExRf/wzseetu/QARehRbBQDygDUeRt4W29RUvMfhASEAQBQkuuivxInXIQ7YNXUrTPo10NvSG/5dKaMtmAhC3fHSqPEYHIsrIBNt6sXWD+lQD0Mm0BmV9jjdNuT7A+se7BztADPluOK9+o8W9Bz+CLXt/OPn8xoOjxqVDu71UueJ70UGdhbEET39Aex67Zj/XRHJEjcDW/Fm7V/66AsGEqYHyvbk7rv2ngbrD4AK1Pt+8aX06AHvDN0LJADA9PPzC/6BCfMLhgNB+Gj0K/sEBgUL4wWn+7z1T/nFAl4JQgex/qP3Z/j9/0kHuwcwAdX5U/jM/QoFdQcNAxL86PhD/NsCngZEBCr+9Pld++UA1Qb3BLL+2fm9+lYAagVpBYcAXfuV+rf+2ANPBe0B8fzp+oz9SgLJBN4Ccf6X+9X84AD6A14DwP9//In8sv8CA3sDywCA/Zf8yv7+AUcDjgGA/uv8Lf4HAdgCBgJp/2/92f0vAEQCOQIsAA3+xf2C/58BMQLDALT+5P0E//sA/QEpAVP/Kv62/mUAqQFgAd7/if4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" type="audio/wav" />
                    Your browser does not support the audio element.
                </audio>
              </div><div class="output text_html">
                <audio  controls="controls" >
                    <source src="data:audio/wav;base64,UklGRsQPAABXQVZFZm10IBAAAAABAAEAoA8AAEAfAAACABAAZGF0YaAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPzjMBwvLKvHTMAcVAtSz5Z8moB4k3wTe3BpgJD3rLNqzDmImM/fn2SwDDCUWArLcGvn2IDML4uEQ8d0aFBKz6GbriBOAFlvwNui8C3wYH/hi5ygEOhhe/6PoX/0VFpcFj+vM94EScwqs77Lz+w3DDXr0LvEECX0PfPk38BIEuw9F/qXwif+wDnwCPPK0+6EM4QWu9Mj44AlOCKr33fa+BrYJ3/r19YkDJAoC/vv1hgCzCdcAzfbr/Y0IMAM6+Nz75QbvBA/6cPrvBAgGGPyq+d8CfAYk/oP54wBcBgcA5fkh/78FogG1+rL9xATgAtL7qfyNA7QDGv0K/DwCHQRs/tT78AAkBK3/+vvC/9UDxABt/MX+QwOiARj9B/6FAj8C5P2N/bABlwK9/lf92ACtApD/X/0OAIkCSwCb/WL/NwLmAP/93P7EAVgBff6A/j4BnQEI/1H+swC3AZH/S/4uAKsBDgBo/rr/vTlFCKzJhfANMtEV8NLL5IYnnx9q3vbcaRt4JdzqEtnpDnknJvfn2SwDDCUWArLcGvn2IDML4uEQ8d0aFBKz6GbriBOAFlvwNui8C3wYH/hi5ygEOhhe/6PoX/0VFpcFj+vM94EScwqs77Lz+w3DDXr0LvEECX0PfPk38BIEuw9F/qXwif+wDnwCPPK0+6EM4QWu9Mj44AlOCKr33fa+BrYJ3/r19YkDJAoC/vv1hgCzCdcAzfbr/Y0IMAM6+Nz75QbvBA/6cPrvBAgGGPyq+d8CfAYk/oP54wBcBgcA5fkh/78FogG1+rL9xATgAtL7qfyNA7QDGv0K/DwCHQRs/tT78AAkBK3/+vvC/9UDxABt/MX+QwOiARj9B/6FAj8C5P2N/bABlwK9/lf92ACtApD/X/0OAIkCSwCb/WL/NwLmAP/93P7EAVgBff6A/j4BnQEI/1H+swC3AZH/S/4uAKsBDgBo/rr/fgF5AKL+XP85AcoA7/4Y/+YA/gBG//L+jQAXAZ//5v42ABYB8/8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA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" type="audio/wav" />
                    Your browser does not support the audio element.
                </audio>
              </div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mixed sounds</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">D</span><span class="p">):</span>
    <span class="n">ipd</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">ipd</span><span class="o">.</span><span class="n">Audio</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="n">rate</span><span class="o">=</span><span class="mi">4000</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
                <audio  controls="controls" >
                    <source src="data:audio/wav;base64,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" type="audio/wav" />
                    Your browser does not support the audio element.
                </audio>
              </div><div class="output text_html">
                <audio  controls="controls" >
                    <source src="data:audio/wav;base64,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" type="audio/wav" />
                    Your browser does not support the audio element.
                </audio>
              </div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Separated sounds</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">D</span><span class="p">):</span>
    <span class="n">ipd</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">ipd</span><span class="o">.</span><span class="n">Audio</span><span class="p">(</span><span class="n">U</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="n">rate</span><span class="o">=</span><span class="mi">4000</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
                <audio  controls="controls" >
                    <source src="data:audio/wav;base64,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" type="audio/wav" />
                    Your browser does not support the audio element.
                </audio>
              </div><div class="output text_html">
                <audio  controls="controls" >
                    <source src="data:audio/wav;base64,UklGRsQPAABXQVZFZm10IBAAAAABAAEAoA8AAEAfAAACABAAZGF0YaAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAHAMv/8v8xABUA1P/m/yYAHgDg/97/GgAkAOz/2/8OACYA+P/a/wMAJQACAN3/+v8hAAsA4v/x/xoAEgDp/+z/EwAWAPH/6f8LABgA+f/o/wQAGAAAAOn//v8WAAUA7P/4/xIACgDw//T/DgANAPX/8v8JAA8A+v/x/wQADwD///H/AAAOAAIA8//8/wwABQD1//n/CQAIAPj/9/8GAAkAcknHTdoL0MG1suTp4DIhS6oeS9iDuHHa3hyoQuQqaO0Sw0/RGwn/f85+UAsrktGAzuI/W7Z8cixCtzmIBsfANr5wykJs2guYAbZ8FdhdxU5J+TGtuq59+TRHq1ETErDE068Q5GwvFE0XJC3cXbd71cQYFkNBL5fxWMObzeQElzUSNKwD29GWy9L0hyaMM5IRF+FjzibpdBfMLgsbr++61NbhogkxJz8ggPxQ3aHe+/3pHaEh4wb85uDe9PQhFO8feg6n8NfhBe/JCrUbLhPB+cbmNOtfApgWghX2AHnsherq+ysQIhX9BgzzbOuw9gsKlBPzCsn49u3a81gEPBAhDV3+jvE18lv/pAzxDYoCWvVe8sD7gQgfDdAFivl78/P4pQS0C9oHDv1o9aT3QQFTCboIVADq9xH3Wv7jBtkIswJi+oP3ZfxHBAEIbAT//IT49PrkAd8GagUd/+b5a/rq/z4FqgX/AJf7VvpC/qEDgwVPAin9z/o6/QQCzASlTJRMcQdMvkiz4u1+NhxLOBsd1g24BNwGH3ZDoilD6wrCUtIkC6s3QjCo/SbPfs5++sAphjFTDOTesc+o7OkZBS7cFxLtBdWm5FQMWyfWHcf5vtym4KsA0R7/H0sE0OUg4GX3hBUSHzoMF+9a4trwbwy4G2oR1Peb5vLsNwTIFhQUX/8K7HnrcP0AEXcUWgUC8gjsSvgFCxcToAna9x/u5/RrBWYQKgwj/UjxJ/OJAOsMKw2IAfj02vKs/BsJ1wzaBND4uPPl+VYFhgsTB2z8afU7+PABhQk5CJH/o/eQ9xn/JgdxCBICFvq+9/H8sQTpB98DgfyT+H/7XQLVBvcEsv7Z+b36VgBpBWkFhwBd+5X6t/7YA08F7QHx/On6jP1KAskE3gJx/pj71fzgAPoDXgPA/3/8ifyy/wEDegPLAIH9l/zK/v4BRwOOAYD+6/wt/gcB2AIGAmn/b/3Z/S8ARAI5AiwADf7F/YL/nwExAsMAtP7k/QT/+wD8ASkBU/8q/rb+ZQCpAWAB3v+J/gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHdJ0U3WC8bBt7Lu6d8yGEupHlTYhbho2tscr0LoKmHtDcNV0SEJgjb3MH//a9AXztr4YSikMcgN6N60z6Ts5hkILuAXEO0B1afkWAxaJ9Idx/nC3KfgpwDQHgIgTATN5R7gaPeGFQ8fNwwZ71zi2PBsDLkbbRHT95nm8+w6BMgWEhRf/wzseetu/f8QeRRbBQHyB+xL+AcLFhOeCdv3Ie7m9GkFZhArDCP9RvEn84oA6wwpDYcB+vTa8qv8GgnYDNsEz/i38+b5VwWFCxIHbPxq9Tr47wGFCTkIkf+j95D3Gf8mB3EIEgIW+r738fyxBOkH3wOB/JP4f/tdAtUG9wSy/tn5vfpWAGkFaQWHAF37lfq3/tgDTwXtAfH86fqM/UoCyQTeAnH+mPvV/OAA+gNeA8D/f/yJ/LL/AQN6A8sAgf2X/Mr+/gFHA44BgP7r/C3+BwHYAgYCaf9v/dn9LwBEAjkCLAAN/sX9gv+fATECwwC0/uT9BP/7AHRL+k4oC/C/bbFT6og0eUyGHtzWhbho2tscr0LoKmHtDcNV0SEJgjb3MH//a9AXztr4YSikMcgN6N60z6Ts5hkILuAXEO0B1afkWAxaJ9Idx/nC3KfgpwDQHgIgTATN5R7gaPeGFQ8fNwwZ71zi2PBsDLkbbRHT95nm8+w6BMgWEhRf/wzseetu/f8QeRRbBQHyB+xL+AcLFhOeCdv3Ie7m9GkFZhArDCP9RvEn84oA6wwpDYcB+vTa8qv8GgnYDNsEz/i38+b5VwWFCxIHbPxq9Tr47wGFCTkIkf+j95D3Gf8mB3EIEgIW+r738fyxBOkH3wOB/JP4f/tdAtUG9wSy/tn5vfpWAGkFaQWHAF37lfq3/tgDTwXtAfH86fqM/UoCyQTeAnH+mPvV/OAA+gNeA8D/f/yJ/LL/AQN6A8sAgf2X/Mr+/gFHA44BgP7r/C3+BwHYAgYCaf9v/dn9LwBEAjkCLAAN/sX9gv+fATECwwC0/uT9BP/7APwBKQFT/yr+tv5lAKkBYAHe/4n+AAAAAAAAAAAAADgABwDL//L/MQAVANT/5v8mAB4A4P/e/xoAJADs/9v/DgAmAPj/2v8DACUAAgDd//r/IQALAOL/8f8aABIA6f/s/xMAFgDx/+n/CwAYAPn/6P8EABgAAADp//7/FgAFAOz/+P8SAAoA8P/0/w4ADQD1//L/CQAPAPr/8f8EAA8A///x/wAADgACAPP//P8MAAUA9f/5/wkACAD4//f/BgAJAPv/9v8DAAoA/v/2/wAACQAAAPf//v8IAAMA+f/8/wYABAD7//v/BAAGAP3/+v8CAAYA///6/wAABgAAAPr/AAAFAAEA+//+/wQAAgD8//3/AwADAP7//f8CAAQA///8/wAABAAAAPz/AAADAAAA/f///wMAAQD+////AgACAP7//v8BAAIA///+/wAAAgAAAP7/AAACAAAA/v8AAAIAAAD+////AQABAP////8BAAEAAAD//wAAAQAAAP//AAABAAAA//8AAAEAAAD//wAAAQAAAP//AAAAAAEAAAD//wAAOQAHAMr/KQA5AOD/xf8WADsA8//F/wQAOQADAMr/9f8zABEA0v/p/ykAHADc/+D/HgAjAOj/2/8SACYA9P9RSddN/AvFwZOy6ekCMyFLiR5H2BkCSSiYKGIEtt1k19v1VRzYJ+4OcunN2U3t3hC/I6oVsPQ13w3oIAaUHXcZff7l5d7lcv1YFhQaMwaR7XvmoPaeDowY7wsA9eToJvKHBzoVPw/P++zsxu8gAdMQxBCNAYLxMe8n/AsMbBBPT0NEF/w8uuC5yvi7OypG7RCNzl27yOY4J85BCCCu4ibCr9rrE+44JCnm9LvMWtQAAyAt7yw8BErZ7tJ79SggJyzdD2fmp9W56zIT1ifCF+HyQ9u15a4HMCG7G7D9+eJN42b9+xhKHa4Gyepq40326xAFG5gMoPPT5sPwKgjAF0MRBvsf6gruEgINEw8SMQEW8KztqvtNDYESkwbs9CTuBPiNCHAQSwla+gfxR/UKA84Nugvk/n7zEfR6/64KsgtTAmD3dPTm++MGagtcBYf6IvXy+fgD1gmiBsP9Qfe2+KgA3ge/B30ABPlE+Jr+1AVsB10Ce/vb+Kr8ZQPrBgUEfv2C+af7nwHHBY8EY//++pv8x/8dA5ADsgBC/YD8/v47AkQDyQJ7/q37zvzLAP0DcwO//2v8hvzF/wYDaQPEAJH9oPy8/vMBUwOaAXb+3vw1/hUB0gL4AW3/fP3X/SIARAJFAi8AAf7B/Y3/pAEnAr0AvP7s/f3+8wACAjEBTv8i/rn+bgCnAVgB3v+R/gAA+P///wcAAgD6//3/BgAEAPv//P8EAAUA/f/7/wIABQD///v/AAAFAAAA+/8AAAQAOQADAMn/9v8zABEA0f/p/ykAHADc/+D/HgAjAOj/2/8SACYA9f/a/wUAJQAAANz//P8iAAoA4f/y/xwAEQDo/+z/FAAWAPH/6f8LABgA+f/o/wQAGAAAAOn//v8WAAUA7P/4/xIACgDw//T/DgANAPX/8v8JAA8A+v/x/wQADwD///H/AAAOAAIA8//8/wwABQD1//n/CQAIAPj/9/8GAAkA+//2/wMACgD+//b/AAAJAAAA9//+/wgAAwD5//z/BgAEAPv/+/8EAAYA/f/6/wIABgD///r/AAAGAAAA+v8AAAUAAQD7//7/BAACAPz//f8DAAMA/v/9/wIABAD///z/AAAEAAAA/P8AAAMAAAD9////AwABAP7///8CAAIA/v/+/3lJ003VC8TBuLLw6d8yFUupHlfYhrhm2tocskLpKl/tDMNX0SIJgDb1MID/bdAWztj4YiimMcgN5t60z6bs5hkGLt8XEu0B1abkVwxbJ9MdxvnB3KfgqADPHgEgTQTO5R7gZveHFRAfNwwZ71zi2PBsDLkbbRHT95nm8+w6BMgWEhRf/wzseetu/f8QeRRbBQHyfjUcRt0W3NSPvNDhyyDuP0Mk0OiFxHDXRw71NVIrK/pS0AHTBv42KbAtvgg73c3SrPE9HIsr/BJn6ujWG+kxDzMm6hmn9iLdI+QOBAAf2xzVAD/l0eK1+nUW9xwWCbbt5uPl8y8OlBqADub1ZueU7zUGaRbREUv99utr7aH/bBHCEicDYPF37V362AsEErQHzfbX7rf2qwbwD3QKzfuJ8a704AHlDOQLLgC89OnzD/6LCfELewNB+HP0LPv7BQIL7AWr+7X1S/nMAmIJPAer/qn3bfj5/0IHvQc2AdP5TfjN/REFdAcHAxL87vhE/NUCnAZJBC3+8PlZ++kA2Ab0BK7+2/nB+lQAZQVqBYsAXfuR+rf+3ANPBeoB8Pzs+o79RwLHBOACc/6W+9L84gD8A1wDvf+A/Iv8sv//AnoDzgCB/ZT8yf4AAkgDjAF//uz8Lv4GAdYCBwJr/2791/0wAEYCOAIrAA7+xv2C/54BMQLEALT+4/0D//wA/QEoAVL/K/63/mQAqAFhAd//iP7//wAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" type="audio/wav" />
                    Your browser does not support the audio element.
                </audio>
              </div></div>
</div>
</section>
<section id="receptive-fields-of-visual-cortex-neurons">
<h2>Receptive fields of visual cortex neurons<a class="headerlink" href="#receptive-fields-of-visual-cortex-neurons" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Cat visual cortex (Hubel &amp; Wiesel)</p></li>
<li><p>Self-organization (von der Malsburgh)</p></li>
<li><p>by Informax (Linsker)</p></li>
<li><p>by SOM (Obermayer et al.)</p></li>
<li><p>by PCA (Sanger et al.)</p></li>
<li><p>by ICA (Bell &amp; Sejnowski)</p></li>
</ul>
<section id="replicating-receptive-field-tuning">
<h3>Replicating receptive field tuning<a class="headerlink" href="#replicating-receptive-field-tuning" title="Link to this heading">#</a></h3>
<p>Sanger (1989) applied <em>generalized Hebbian learning</em> to patches from natural images as inputs.
The PCs learned as the input weights were similar to the receptive field propertis of visual cortical neurons.</p>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Bishop CM (2006) Pattern Recognition and Machine Learning. Springer. <a class="reference external" href="https://www.microsoft.com/en-us/research/people/cmbishop/prml-book/">https://www.microsoft.com/en-us/research/people/cmbishop/prml-book/</a></p>
<ul>
<li><p>Chapter 9: Mixture models and EM</p></li>
<li><p>Chapter 12: Continuous latent variables</p></li>
</ul>
</li>
<li><p>Murphy K (2012) Machine learning: A probabilistic perspective. MIT press. <a class="reference external" href="https://probml.github.io/pml-book/">https://probml.github.io/pml-book/</a></p>
<ul>
<li><p>Chapter 25.2: Dirichlet process mixture models</p></li>
</ul>
</li>
</ul>
<section id="self-organization">
<h3>Self Organization<a class="headerlink" href="#self-organization" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Hubel DH, Wiesel TN (1959). Receptive fields of single neurones in the catâ€™s striate cortex. Journal of Physiology, 148, 574-91. <a class="reference external" href="http://doi.org/10.1113/jphysiol.1959.sp006308">http://doi.org/10.1113/jphysiol.1959.sp006308</a></p></li>
<li><p>Hubel DH, Wiesel TN (1962). Receptive fields, binocular interaction and functional architecture in the catâ€™s visual cortex. Journal of Physiology, 160, 106-154. <a class="reference external" href="http://doi.org/10.1113/jphysiol.1962.sp006837">http://doi.org/10.1113/jphysiol.1962.sp006837</a></p></li>
<li><p>von der Malsburg C (1973). Self-organization of orientation sensitive cells in the striate cortex. Kybernetik, 14, 85-100. <a class="reference external" href="https://doi.org/10.1007/BF00288907">https://doi.org/10.1007/BF00288907</a></p></li>
<li><p>Kohonen T (1982). Self-Organized Formation of Topologically Correct Feature Maps. Biol Cybern, 43, 59-69. <a class="reference external" href="https://doi.org/10.1007/BF00337288">https://doi.org/10.1007/BF00337288</a></p></li>
<li><p>Olshausen BA, Field DJ (1996). Emergence of simple-cell receptive field properties by learning a sparse code for natural images. Nature, 381, 607-9. <a class="reference external" href="https://doi.org/10.1038/381607a0">https://doi.org/10.1038/381607a0</a></p></li>
<li><p>Rao RP, Ballard DH (1999). Predictive coding in the visual cortex: a functional interpretation of some extra-classical receptive-field effects. Nat Neurosci, 2, 79-87. <a class="reference external" href="https://doi.org/10.1038/4580">https://doi.org/10.1038/4580</a></p></li>
</ul>
</section>
<section id="pca">
<h3>PCA<a class="headerlink" href="#pca" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Sanger TD (1989). Optimal unsupervised learning in a single-layer linear feedforward neural network. Neural Networks, 2, 459-473. <a class="reference external" href="http://doi.org/10.1016/0893-6080(89)90044-0">http://doi.org/10.1016/0893-6080(89)90044-0</a></p></li>
<li><p>Turk M, Pentland A (1991). Eigenfaces for recognition. Journal of Cognitive Neurosciece, 3, 71-86. <a class="reference external" href="http://doi.org/10.1162/jocn.1991.3.1.71">http://doi.org/10.1162/jocn.1991.3.1.71</a></p></li>
</ul>
</section>
<section id="infomax-and-ica">
<h3>Infomax and ICA<a class="headerlink" href="#infomax-and-ica" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Linsker R (1986). From basic network principles to neural architecture. Proceedings of the National Academy of Sciences, USA, 83, 7508-7512, 8390-8394, 8779-8783.  <a class="reference external" href="http://doi.org/10.1073/pnas.83.19.7508">http://doi.org/10.1073/pnas.83.19.7508</a></p></li>
<li><p>Bell AJ, Sejnowski TJ (1995). An information-maxization approach to blind separation and blind deconvolution. Neural Comput, 7, 1129-1159. <a class="reference external" href="http://doi.org/10.1162/neco.1995.7.6.1129">http://doi.org/10.1162/neco.1995.7.6.1129</a></p></li>
<li><p>Bell AJ, Sejnowski TJ (1997). The â€œindependent componentsâ€ of natural scenes are edge filters. Vision Research, 37, 3327-3338. <a class="reference external" href="http://doi.org/10.1016/s0042-6989(97)00121-1">http://doi.org/10.1016/s0042-6989(97)00121-1</a></p></li>
<li><p>Amari S (1998). Natural gradient works efficiently in learning. Neural Comput, 10, 251-276. <a class="reference external" href="http://doi.org/10.1162/089976698300017746">http://doi.org/10.1162/089976698300017746</a></p></li>
</ul>
</section>
</section>
<div class="toctree-wrapper compound">
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Reinforcement_Exercise.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chapter 4. Reinforcement Learning: Exercise</p>
      </div>
    </a>
    <a class="right-next"
       href="Unsupervised_Exercise.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Unsupervised Learning: Exercise</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contents">Contents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scikit-learn">scikit-learn</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k-means-clustering">K-means Clustering</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mixtures-of-gaussians">Mixtures of Gaussians</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#expectation-maximization-em-algorithm">Expectation-Maximization (EM) Algorithm</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#e-expectation-step">E (expectation) step</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#m-maximization-step">M (maximization) step</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dirichlet-process-mixture">Dirichlet Process Mixture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hierarchical-clustering">Hierarchical clustering</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#principal-component-analysis">Principal Component Analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#singular-value-decomposition-svd">Singular value decomposition (SVD)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#online-pca">Online PCA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#infomax-principle">Infomax principle</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#independent-component-analysis-ica">Independent component analysis (ICA)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ica-by-infomax">ICA by Infomax</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#playing-sound">Playing sound</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#receptive-fields-of-visual-cortex-neurons">Receptive fields of visual cortex neurons</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#replicating-receptive-field-tuning">Replicating receptive field tuning</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#self-organization">Self Organization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pca">PCA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#infomax-and-ica">Infomax and ICA</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kenji Doya
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>